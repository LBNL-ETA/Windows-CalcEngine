#include <memory>
#include <gtest/gtest.h>

#include "WCESpectralAveraging.hpp"
#include "WCEMultiLayerOptics.hpp"
#include "WCESingleLayerOptics.hpp"
#include "WCECommon.hpp"

using FenestrationCommon::CSeries;
using FenestrationCommon::PropertySimple;
using FenestrationCommon::Side;
using FenestrationCommon::Scattering;
using SpectralAveraging::CSpectralSampleData;
using SingleLayerOptics::Material;
using MultiLayerOptics::CMultiPaneSpecular;

class Photovoltaic_DoublePane_Example2 : public testing::Test
{
private:
    std::unique_ptr<CMultiPaneSpecular> m_Layer;

    static CSeries loadSolarRadiationFile()
    {
        // Full ASTM E891-87 Table 1 (Solar radiation)
        CSeries aSolarRadiation(
          {{0.3000, 0.0},    {0.3050, 3.4},    {0.3100, 15.6},   {0.3150, 41.1},   {0.3200, 71.2},
           {0.3250, 100.2},  {0.3300, 152.4},  {0.3350, 155.6},  {0.3400, 179.4},  {0.3450, 186.7},
           {0.3500, 212.0},  {0.3600, 240.5},  {0.3700, 324.0},  {0.3800, 362.4},  {0.3900, 381.7},
           {0.4000, 556.0},  {0.4100, 656.3},  {0.4200, 690.8},  {0.4300, 641.9},  {0.4400, 798.5},
           {0.4500, 956.6},  {0.4600, 990.0},  {0.4700, 998.0},  {0.4800, 1046.1}, {0.4900, 1005.1},
           {0.5000, 1026.7}, {0.5100, 1066.7}, {0.5200, 1011.5}, {0.5300, 1084.9}, {0.5400, 1082.4},
           {0.5500, 1102.2}, {0.5700, 1087.4}, {0.5900, 1024.3}, {0.6100, 1088.8}, {0.6300, 1062.1},
           {0.6500, 1061.7}, {0.6700, 1046.2}, {0.6900, 859.2},  {0.7100, 1002.4}, {0.7180, 816.9},
           {0.7244, 842.8},  {0.7400, 971.0},  {0.7525, 956.3},  {0.7575, 942.2},  {0.7625, 524.8},
           {0.7675, 830.7},  {0.7800, 908.9},  {0.8000, 873.4},  {0.8160, 712.0},  {0.8237, 660.2},
           {0.8315, 765.5},  {0.8400, 799.8},  {0.8600, 815.2},  {0.8800, 778.3},  {0.9050, 630.4},
           {0.9150, 565.2},  {0.9250, 586.4},  {0.9300, 348.1},  {0.9370, 224.2},  {0.9480, 271.4},
           {0.9650, 451.2},  {0.9800, 549.7},  {0.9935, 630.1},  {1.0400, 582.9},  {1.0700, 539.7},
           {1.1000, 366.2},  {1.1200, 98.1},   {1.1300, 169.5},  {1.1370, 118.7},  {1.1610, 301.9},
           {1.1800, 406.8},  {1.2000, 375.2},  {1.2350, 423.6},  {1.2900, 365.7},  {1.3200, 223.4},
           {1.3500, 30.1},   {1.3950, 1.4},    {1.4425, 51.6},   {1.4625, 97.0},   {1.4770, 97.3},
           {1.4970, 167.1},  {1.5200, 239.3},  {1.5390, 248.8},  {1.5580, 249.3},  {1.5780, 222.3},
           {1.5920, 227.3},  {1.6100, 210.5},  {1.6300, 224.7},  {1.6460, 215.9},  {1.6780, 202.8},
           {1.7400, 158.2},  {1.8000, 28.6},   {1.8600, 1.8},    {1.9200, 1.1},    {1.9600, 19.7},
           {1.9850, 84.9},   {2.0050, 25.0},   {2.0350, 92.5},   {2.0650, 56.3},   {2.1000, 82.7},
           {2.1480, 76.2},   {2.1980, 66.4},   {2.2700, 65.0},   {2.3600, 57.6},   {2.4500, 19.8},
           {2.4940, 17.0},   {2.5370, 3.0},    {2.9410, 4.0},    {2.9730, 7.0},    {3.0050, 6.0},
           {3.0560, 3.0},    {3.1320, 5.0},    {3.1560, 18.0},   {3.2040, 1.2},    {3.2450, 3.0},
           {3.3170, 12.0},   {3.3440, 3.0},    {3.4500, 12.2},   {3.5730, 11.0},   {3.7650, 9.0},
           {4.0450, 6.9}

          });

        return aSolarRadiation;
    }

    std::shared_ptr<CSpectralSampleData> loadSampleData_NFRC_102() const
    {
        auto aMeasurements_102 = CSpectralSampleData::create(
          {{0.300, 0.0020, 0.0470, 0.0480}, {0.305, 0.0030, 0.0470, 0.0480},
           {0.310, 0.0090, 0.0470, 0.0480}, {0.315, 0.0350, 0.0470, 0.0480},
           {0.320, 0.1000, 0.0470, 0.0480}, {0.325, 0.2180, 0.0490, 0.0500},
           {0.330, 0.3560, 0.0530, 0.0540}, {0.335, 0.4980, 0.0600, 0.0610},
           {0.340, 0.6160, 0.0670, 0.0670}, {0.345, 0.7090, 0.0730, 0.0740},
           {0.350, 0.7740, 0.0780, 0.0790}, {0.355, 0.8180, 0.0820, 0.0820},
           {0.360, 0.8470, 0.0840, 0.0840}, {0.365, 0.8630, 0.0850, 0.0850},
           {0.370, 0.8690, 0.0850, 0.0860}, {0.375, 0.8610, 0.0850, 0.0850},
           {0.380, 0.8560, 0.0840, 0.0840}, {0.385, 0.8660, 0.0850, 0.0850},
           {0.390, 0.8810, 0.0860, 0.0860}, {0.395, 0.8890, 0.0860, 0.0860},
           {0.400, 0.8930, 0.0860, 0.0860}, {0.410, 0.8930, 0.0860, 0.0860},
           {0.420, 0.8920, 0.0860, 0.0860}, {0.430, 0.8920, 0.0850, 0.0850},
           {0.440, 0.8920, 0.0850, 0.0850}, {0.450, 0.8960, 0.0850, 0.0850},
           {0.460, 0.9000, 0.0850, 0.0850}, {0.470, 0.9020, 0.0840, 0.0840},
           {0.480, 0.9030, 0.0840, 0.0840}, {0.490, 0.9040, 0.0850, 0.0850},
           {0.500, 0.9050, 0.0840, 0.0840}, {0.510, 0.9050, 0.0840, 0.0840},
           {0.520, 0.9050, 0.0840, 0.0840}, {0.530, 0.9040, 0.0840, 0.0840},
           {0.540, 0.9040, 0.0830, 0.0830}, {0.550, 0.9030, 0.0830, 0.0830},
           {0.560, 0.9020, 0.0830, 0.0830}, {0.570, 0.9000, 0.0820, 0.0820},
           {0.580, 0.8980, 0.0820, 0.0820}, {0.590, 0.8960, 0.0810, 0.0810},
           {0.600, 0.8930, 0.0810, 0.0810}, {0.610, 0.8900, 0.0810, 0.0810},
           {0.620, 0.8860, 0.0800, 0.0800}, {0.630, 0.8830, 0.0800, 0.0800},
           {0.640, 0.8790, 0.0790, 0.0790}, {0.650, 0.8750, 0.0790, 0.0790},
           {0.660, 0.8720, 0.0790, 0.0790}, {0.670, 0.8680, 0.0780, 0.0780},
           {0.680, 0.8630, 0.0780, 0.0780}, {0.690, 0.8590, 0.0770, 0.0770},
           {0.700, 0.8540, 0.0760, 0.0770}, {0.710, 0.8500, 0.0760, 0.0760},
           {0.720, 0.8450, 0.0750, 0.0760}, {0.730, 0.8400, 0.0750, 0.0750},
           {0.740, 0.8350, 0.0750, 0.0750}, {0.750, 0.8310, 0.0740, 0.0740},
           {0.760, 0.8260, 0.0740, 0.0740}, {0.770, 0.8210, 0.0740, 0.0740},
           {0.780, 0.8160, 0.0730, 0.0730}, {0.790, 0.8120, 0.0730, 0.0730},
           {0.800, 0.8080, 0.0720, 0.0720}, {0.810, 0.8030, 0.0720, 0.0720},
           {0.820, 0.8000, 0.0720, 0.0720}, {0.830, 0.7960, 0.0710, 0.0710},
           {0.840, 0.7930, 0.0700, 0.0710}, {0.850, 0.7880, 0.0700, 0.0710},
           {0.860, 0.7860, 0.0700, 0.0700}, {0.870, 0.7820, 0.0740, 0.0740},
           {0.880, 0.7800, 0.0720, 0.0720}, {0.890, 0.7770, 0.0730, 0.0740},
           {0.900, 0.7760, 0.0720, 0.0720}, {0.910, 0.7730, 0.0720, 0.0720},
           {0.920, 0.7710, 0.0710, 0.0710}, {0.930, 0.7700, 0.0700, 0.0700},
           {0.940, 0.7680, 0.0690, 0.0690}, {0.950, 0.7660, 0.0680, 0.0680},
           {0.960, 0.7660, 0.0670, 0.0680}, {0.970, 0.7640, 0.0680, 0.0680},
           {0.980, 0.7630, 0.0680, 0.0680}, {0.990, 0.7620, 0.0670, 0.0670},
           {1.000, 0.7620, 0.0660, 0.0670}, {1.050, 0.7600, 0.0660, 0.0660},
           {1.100, 0.7590, 0.0660, 0.0660}, {1.150, 0.7610, 0.0660, 0.0660},
           {1.200, 0.7650, 0.0660, 0.0660}, {1.250, 0.7700, 0.0650, 0.0650},
           {1.300, 0.7770, 0.0670, 0.0670}, {1.350, 0.7860, 0.0660, 0.0670},
           {1.400, 0.7950, 0.0670, 0.0680}, {1.450, 0.8080, 0.0670, 0.0670},
           {1.500, 0.8190, 0.0690, 0.0690}, {1.550, 0.8290, 0.0690, 0.0690},
           {1.600, 0.8360, 0.0700, 0.0700}, {1.650, 0.8400, 0.0700, 0.0700},
           {1.700, 0.8420, 0.0690, 0.0700}, {1.750, 0.8420, 0.0690, 0.0700},
           {1.800, 0.8410, 0.0700, 0.0700}, {1.850, 0.8400, 0.0690, 0.0690},
           {1.900, 0.8390, 0.0680, 0.0680}, {1.950, 0.8390, 0.0710, 0.0710},
           {2.000, 0.8390, 0.0690, 0.0690}, {2.050, 0.8400, 0.0680, 0.0680},
           {2.100, 0.8410, 0.0680, 0.0680}, {2.150, 0.8390, 0.0690, 0.0690},
           {2.200, 0.8300, 0.0700, 0.0700}, {2.250, 0.8300, 0.0700, 0.0700},
           {2.300, 0.8320, 0.0690, 0.0690}, {2.350, 0.8320, 0.0690, 0.0700},
           {2.400, 0.8320, 0.0700, 0.0700}, {2.450, 0.8260, 0.0690, 0.0690},
           {2.500, 0.8220, 0.0680, 0.0680}});

        return aMeasurements_102;
    }

    static CSeries eqeFront()
    {
        CSeries eqe({{0.300, 0.00569},  {0.305, 0.036081}, {0.310, 0.098415}, {0.315, 0.140809},
                     {0.320, 0.175428}, {0.325, 0.22063},  {0.330, 0.271745}, {0.335, 0.324105},
                     {0.340, 0.364687}, {0.345, 0.387123}, {0.350, 0.393164}, {0.355, 0.381717},
                     {0.360, 0.378066}, {0.365, 0.368147}, {0.370, 0.343396}, {0.375, 0.326597},
                     {0.380, 0.295813}, {0.385, 0.278894}, {0.390, 0.267678}, {0.395, 0.254845},
                     {0.400, 0.247495}, {0.405, 0.245735}, {0.410, 0.24205},  {0.415, 0.237753},
                     {0.420, 0.233943}, {0.425, 0.232813}, {0.430, 0.231604}, {0.435, 0.228474},
                     {0.440, 0.222221}, {0.445, 0.218546}, {0.450, 0.20864},  {0.455, 0.203837},
                     {0.460, 0.193092}, {0.465, 0.183282}, {0.470, 0.173378}, {0.475, 0.164734},
                     {0.480, 0.153668}, {0.485, 0.143934}, {0.490, 0.133364}, {0.495, 0.122443},
                     {0.500, 0.111509}, {0.505, 0.101311}, {0.510, 0.072048}, {0.515, 0.081689},
                     {0.520, 0.073833}, {0.525, 0.066798}, {0.530, 0.061911}, {0.535, 0.057746},
                     {0.540, 0.055444}, {0.545, 0.053358}, {0.550, 0.052742}, {0.555, 0.05196},
                     {0.560, 0.051268}, {0.565, 0.050969}, {0.570, 0.051342}, {0.575, 0.051644},
                     {0.580, 0.052066}, {0.585, 0.05306},  {0.590, 0.053879}, {0.595, 0.054867},
                     {0.600, 0.056239}, {0.605, 0.05857},  {0.610, 0.061447}, {0.615, 0.063297},
                     {0.620, 0.064221}, {0.625, 0.066032}, {0.630, 0.068444}, {0.635, 0.071138},
                     {0.640, 0.074686}, {0.645, 0.078706}, {0.650, 0.082899}, {0.655, 0.089178},
                     {0.660, 0.09577},  {0.665, 0.103082}, {0.670, 0.112038}, {0.675, 0.119977},
                     {0.680, 0.129053}, {0.685, 0.136601}, {0.690, 0.145948}, {0.695, 0.165281},
                     {0.700, 0.174518}, {0.705, 0.185099}, {0.710, 0.193299}, {0.715, 0.202065},
                     {0.720, 0.213326}, {0.725, 0.223407}, {0.730, 0.231185}, {0.735, 0.240227},
                     {0.740, 0.249194}, {0.745, 0.256674}, {0.750, 0.262732}, {0.755, 0.268445},
                     {0.760, 0.270325}, {0.765, 0.26647},  {0.770, 0.268659}, {0.775, 0.262065},
                     {0.780, 0.253562}, {0.785, 0.240409}, {0.790, 0.224249}, {0.795, 0.206873},
                     {0.800, 0.184883}, {0.805, 0.163541}, {0.810, 0.140102}, {0.815, 0.121169},
                     {0.820, 0.104982}, {0.825, 0.081561}, {0.830, 0.065268}, {0.835, 0.05001},
                     {0.840, 0.038557}, {0.845, 0.028609}, {0.850, 0.021159}, {0.855, 0.015577},
                     {0.860, 0.011237}, {0.865, 0.006077}, {0.870, 0.006142}, {0.875, 0.005064},
                     {0.880, 0.004842}, {0.885, 0.002383}, {0.890, 0.001794}, {0.895, 0.001129},
                     {0.900, 0.000768}, {0.905, 0.000219}, {0.910, 0.000001}, {0.915, 0.000259},
                     {0.920, 0},        {0.925, 0},        {0.930, 0},        {0.935, 0},
                     {0.940, 0},        {0.945, 0},        {0.950, 0},        {0.955, 0},
                     {0.960, 0},        {0.965, 0},        {0.970, 0},        {0.975, 0},
                     {0.980, 0},        {0.985, 0},        {0.990, 0},        {0.995, 0},
                     {1.000, 0},        {1.005, 0},        {1.010, 0},        {1.015, 0},
                     {1.020, 0},        {1.025, 0},        {1.030, 0},        {1.035, 0},
                     {1.040, 0},        {1.045, 0},        {1.050, 0},        {1.055, 0},
                     {1.060, 0},        {1.065, 0},        {1.070, 0},        {1.075, 0},
                     {1.080, 0},        {1.085, 0},        {1.090, 0},        {1.095, 0},
                     {1.100, 0},        {1.105, 0},        {1.110, 0},        {1.115, 0},
                     {1.120, 0},        {1.125, 0},        {1.130, 0},        {1.135, 0},
                     {1.140, 0},        {1.145, 0},        {1.150, 0},        {1.155, 0},
                     {1.160, 0},        {1.165, 0},        {1.170, 0},        {1.175, 0},
                     {1.180, 0},        {1.185, 0},        {1.190, 0},        {1.195, 0},
                     {1.200, 0},        {1.205, 0},        {1.210, 0},        {1.215, 0},
                     {1.220, 0},        {1.225, 0},        {1.230, 0},        {1.235, 0},
                     {1.240, 0},        {1.245, 0},        {1.250, 0},        {1.255, 0},
                     {1.260, 0},        {1.265, 0},        {1.270, 0},        {1.275, 0},
                     {1.280, 0},        {1.285, 0},        {1.290, 0},        {1.295, 0},
                     {1.300, 0},        {1.305, 0},        {1.310, 0},        {1.315, 0},
                     {1.320, 0},        {1.325, 0},        {1.330, 0},        {1.335, 0},
                     {1.340, 0},        {1.345, 0},        {1.350, 0},        {1.355, 0},
                     {1.360, 0},        {1.365, 0},        {1.370, 0},        {1.375, 0},
                     {1.380, 0},        {1.385, 0},        {1.390, 0},        {1.395, 0},
                     {1.400, 0},        {1.405, 0},        {1.410, 0},        {1.415, 0},
                     {1.420, 0},        {1.425, 0},        {1.430, 0},        {1.435, 0},
                     {1.440, 0},        {1.445, 0},        {1.450, 0},        {1.455, 0},
                     {1.460, 0},        {1.465, 0},        {1.470, 0},        {1.475, 0},
                     {1.480, 0},        {1.485, 0},        {1.490, 0},        {1.495, 0},
                     {1.500, 0},        {1.505, 0},        {1.510, 0},        {1.515, 0},
                     {1.520, 0},        {1.525, 0},        {1.530, 0},        {1.535, 0},
                     {1.540, 0},        {1.545, 0},        {1.550, 0},        {1.555, 0},
                     {1.560, 0},        {1.565, 0},        {1.570, 0},        {1.575, 0},
                     {1.580, 0},        {1.585, 0},        {1.590, 0},        {1.595, 0},
                     {1.600, 0},        {1.605, 0},        {1.610, 0},        {1.615, 0},
                     {1.620, 0},        {1.625, 0},        {1.630, 0},        {1.635, 0},
                     {1.640, 0},        {1.645, 0},        {1.650, 0},        {1.655, 0},
                     {1.660, 0},        {1.665, 0},        {1.670, 0},        {1.675, 0},
                     {1.680, 0},        {1.685, 0},        {1.690, 0},        {1.695, 0},
                     {1.700, 0},        {1.705, 0},        {1.710, 0},        {1.715, 0},
                     {1.720, 0},        {1.725, 0},        {1.730, 0},        {1.735, 0},
                     {1.740, 0},        {1.745, 0},        {1.750, 0},        {1.755, 0},
                     {1.760, 0},        {1.765, 0},        {1.770, 0},        {1.775, 0},
                     {1.780, 0},        {1.785, 0},        {1.790, 0},        {1.795, 0},
                     {1.800, 0},        {1.805, 0},        {1.810, 0},        {1.815, 0},
                     {1.820, 0},        {1.825, 0},        {1.830, 0},        {1.835, 0},
                     {1.840, 0},        {1.845, 0},        {1.850, 0},        {1.855, 0},
                     {1.860, 0},        {1.865, 0},        {1.870, 0},        {1.875, 0},
                     {1.880, 0},        {1.885, 0},        {1.890, 0},        {1.895, 0},
                     {1.900, 0},        {1.905, 0},        {1.910, 0},        {1.915, 0},
                     {1.920, 0},        {1.925, 0},        {1.930, 0},        {1.935, 0},
                     {1.940, 0},        {1.945, 0},        {1.950, 0},        {1.955, 0},
                     {1.960, 0},        {1.965, 0},        {1.970, 0},        {1.975, 0},
                     {1.980, 0},        {1.985, 0},        {1.990, 0},        {1.995, 0},
                     {2.000, 0},        {2.005, 0},        {2.010, 0},        {2.015, 0},
                     {2.020, 0},        {2.025, 0},        {2.030, 0},        {2.035, 0},
                     {2.040, 0},        {2.045, 0},        {2.050, 0},        {2.055, 0},
                     {2.060, 0},        {2.065, 0},        {2.070, 0},        {2.075, 0},
                     {2.080, 0},        {2.085, 0},        {2.090, 0},        {2.095, 0},
                     {2.100, 0},        {2.105, 0},        {2.110, 0},        {2.115, 0},
                     {2.120, 0},        {2.125, 0},        {2.130, 0},        {2.135, 0},
                     {2.140, 0},        {2.145, 0},        {2.150, 0},        {2.155, 0},
                     {2.160, 0},        {2.165, 0},        {2.170, 0},        {2.175, 0},
                     {2.180, 0},        {2.185, 0},        {2.190, 0},        {2.195, 0},
                     {2.200, 0},        {2.205, 0},        {2.210, 0},        {2.215, 0},
                     {2.220, 0},        {2.225, 0},        {2.230, 0},        {2.235, 0},
                     {2.240, 0},        {2.245, 0},        {2.250, 0},        {2.255, 0},
                     {2.260, 0},        {2.265, 0},        {2.270, 0},        {2.275, 0},
                     {2.280, 0},        {2.285, 0},        {2.290, 0},        {2.295, 0},
                     {2.300, 0},        {2.305, 0},        {2.310, 0},        {2.315, 0},
                     {2.320, 0},        {2.325, 0},        {2.330, 0},        {2.335, 0},
                     {2.340, 0},        {2.345, 0},        {2.350, 0},        {2.355, 0},
                     {2.360, 0},        {2.365, 0},        {2.370, 0},        {2.375, 0},
                     {2.380, 0},        {2.385, 0},        {2.390, 0},        {2.395, 0},
                     {2.400, 0},        {2.405, 0},        {2.410, 0},        {2.415, 0},
                     {2.420, 0},        {2.425, 0},        {2.430, 0},        {2.435, 0},
                     {2.440, 0},        {2.445, 0},        {2.450, 0},        {2.455, 0},
                     {2.460, 0},        {2.465, 0},        {2.470, 0},        {2.475, 0},
                     {2.480, 0},        {2.485, 0},        {2.490, 0},        {2.495, 0},
                     {2.500, 0}});

        return eqe;
    }

    static CSeries eqeBack()
    {
        CSeries eqe({{0.300, 0},        {0.305, 0.024239}, {0.310, 0.031977}, {0.315, 0.033776},
                     {0.320, 0.036737}, {0.325, 0.042653}, {0.330, 0.053813}, {0.335, 0.071542},
                     {0.340, 0.086217}, {0.345, 0.093003}, {0.350, 0.105437}, {0.355, 0.108406},
                     {0.360, 0.114849}, {0.365, 0.123612}, {0.370, 0.1249},   {0.375, 0.130118},
                     {0.380, 0.129037}, {0.385, 0.128101}, {0.390, 0.127431}, {0.395, 0.125782},
                     {0.400, 0.125978}, {0.405, 0.127636}, {0.410, 0.129033}, {0.415, 0.129343},
                     {0.420, 0.129282}, {0.425, 0.129525}, {0.430, 0.129609}, {0.435, 0.128684},
                     {0.440, 0.125438}, {0.445, 0.122702}, {0.450, 0.118307}, {0.455, 0.11366},
                     {0.460, 0.108154}, {0.465, 0.102145}, {0.470, 0.095649}, {0.475, 0.089853},
                     {0.480, 0.082677}, {0.485, 0.076285}, {0.490, 0.069561}, {0.495, 0.062973},
                     {0.500, 0.056184}, {0.505, 0.050292}, {0.510, 0.044185}, {0.515, 0.039039},
                     {0.520, 0.034569}, {0.525, 0.030699}, {0.530, 0.027805}, {0.535, 0.025371},
                     {0.540, 0.02371},  {0.545, 0.022557}, {0.550, 0.021568}, {0.555, 0.020917},
                     {0.560, 0.020408}, {0.565, 0.019905}, {0.570, 0.019515}, {0.575, 0.01924},
                     {0.580, 0.019041}, {0.585, 0.018912}, {0.590, 0.018806}, {0.595, 0.018705},
                     {0.600, 0.018744}, {0.605, 0.019002}, {0.610, 0.019537}, {0.615, 0.020154},
                     {0.620, 0.02048},  {0.625, 0.020791}, {0.630, 0.020979}, {0.635, 0.021576},
                     {0.640, 0.022463}, {0.645, 0.023581}, {0.650, 0.024931}, {0.655, 0.026389},
                     {0.660, 0.028217}, {0.665, 0.030662}, {0.670, 0.033304}, {0.675, 0.035774},
                     {0.680, 0.03838},  {0.685, 0.041247}, {0.690, 0.044093}, {0.695, 0.048326},
                     {0.700, 0.051128}, {0.705, 0.054585}, {0.710, 0.057618}, {0.715, 0.059728},
                     {0.720, 0.062509}, {0.725, 0.06568},  {0.730, 0.068463}, {0.735, 0.070402},
                     {0.740, 0.072764}, {0.745, 0.074345}, {0.750, 0.075874}, {0.755, 0.077219},
                     {0.760, 0.079576}, {0.765, 0.075944}, {0.770, 0.075258}, {0.775, 0.07274},
                     {0.780, 0.069951}, {0.785, 0.066372}, {0.790, 0.061666}, {0.795, 0.056324},
                     {0.800, 0.049797}, {0.805, 0.043384}, {0.810, 0.036672}, {0.815, 0.031249},
                     {0.820, 0.028539}, {0.825, 0.022973}, {0.830, 0.016857}, {0.835, 0.013271},
                     {0.840, 0.008998}, {0.845, 0.003847}, {0.850, 0.001537}, {0.855, 0.000402},
                     {0.860, 0},        {0.865, 0},        {0.870, 0},        {0.875, 0.000152},
                     {0.880, 0.001018}, {0.885, 0},        {0.890, 0},        {0.895, 0},
                     {0.900, 0},        {0.905, 0},        {0.910, 0},        {0.915, 0},
                     {0.920, 0},        {0.925, 0},        {0.930, 0},        {0.935, 0},
                     {0.940, 0},        {0.945, 0},        {0.950, 0},        {0.955, 0},
                     {0.960, 0},        {0.965, 0},        {0.970, 0},        {0.975, 0},
                     {0.980, 0},        {0.985, 0},        {0.990, 0},        {0.995, 0},
                     {1.000, 0},        {1.005, 0},        {1.010, 0},        {1.015, 0},
                     {1.020, 0},        {1.025, 0},        {1.030, 0},        {1.035, 0},
                     {1.040, 0},        {1.045, 0},        {1.050, 0},        {1.055, 0},
                     {1.060, 0},        {1.065, 0},        {1.070, 0},        {1.075, 0},
                     {1.080, 0},        {1.085, 0},        {1.090, 0},        {1.095, 0},
                     {1.100, 0},        {1.105, 0},        {1.110, 0},        {1.115, 0},
                     {1.120, 0},        {1.125, 0},        {1.130, 0},        {1.135, 0},
                     {1.140, 0},        {1.145, 0},        {1.150, 0},        {1.155, 0},
                     {1.160, 0},        {1.165, 0},        {1.170, 0},        {1.175, 0},
                     {1.180, 0},        {1.185, 0},        {1.190, 0},        {1.195, 0},
                     {1.200, 0},        {1.205, 0},        {1.210, 0},        {1.215, 0},
                     {1.220, 0},        {1.225, 0},        {1.230, 0},        {1.235, 0},
                     {1.240, 0},        {1.245, 0},        {1.250, 0},        {1.255, 0},
                     {1.260, 0},        {1.265, 0},        {1.270, 0},        {1.275, 0},
                     {1.280, 0},        {1.285, 0},        {1.290, 0},        {1.295, 0},
                     {1.300, 0},        {1.305, 0},        {1.310, 0},        {1.315, 0},
                     {1.320, 0},        {1.325, 0},        {1.330, 0},        {1.335, 0},
                     {1.340, 0},        {1.345, 0},        {1.350, 0},        {1.355, 0},
                     {1.360, 0},        {1.365, 0},        {1.370, 0},        {1.375, 0},
                     {1.380, 0},        {1.385, 0},        {1.390, 0},        {1.395, 0},
                     {1.400, 0},        {1.405, 0},        {1.410, 0},        {1.415, 0},
                     {1.420, 0},        {1.425, 0},        {1.430, 0},        {1.435, 0},
                     {1.440, 0},        {1.445, 0},        {1.450, 0},        {1.455, 0},
                     {1.460, 0},        {1.465, 0},        {1.470, 0},        {1.475, 0},
                     {1.480, 0},        {1.485, 0},        {1.490, 0},        {1.495, 0},
                     {1.500, 0},        {1.505, 0},        {1.510, 0},        {1.515, 0},
                     {1.520, 0},        {1.525, 0},        {1.530, 0},        {1.535, 0},
                     {1.540, 0},        {1.545, 0},        {1.550, 0},        {1.555, 0},
                     {1.560, 0},        {1.565, 0},        {1.570, 0},        {1.575, 0},
                     {1.580, 0},        {1.585, 0},        {1.590, 0},        {1.595, 0},
                     {1.600, 0},        {1.605, 0},        {1.610, 0},        {1.615, 0},
                     {1.620, 0},        {1.625, 0},        {1.630, 0},        {1.635, 0},
                     {1.640, 0},        {1.645, 0},        {1.650, 0},        {1.655, 0},
                     {1.660, 0},        {1.665, 0},        {1.670, 0},        {1.675, 0},
                     {1.680, 0},        {1.685, 0},        {1.690, 0},        {1.695, 0},
                     {1.700, 0},        {1.705, 0},        {1.710, 0},        {1.715, 0},
                     {1.720, 0},        {1.725, 0},        {1.730, 0},        {1.735, 0},
                     {1.740, 0},        {1.745, 0},        {1.750, 0},        {1.755, 0},
                     {1.760, 0},        {1.765, 0},        {1.770, 0},        {1.775, 0},
                     {1.780, 0},        {1.785, 0},        {1.790, 0},        {1.795, 0},
                     {1.800, 0},        {1.805, 0},        {1.810, 0},        {1.815, 0},
                     {1.820, 0},        {1.825, 0},        {1.830, 0},        {1.835, 0},
                     {1.840, 0},        {1.845, 0},        {1.850, 0},        {1.855, 0},
                     {1.860, 0},        {1.865, 0},        {1.870, 0},        {1.875, 0},
                     {1.880, 0},        {1.885, 0},        {1.890, 0},        {1.895, 0},
                     {1.900, 0},        {1.905, 0},        {1.910, 0},        {1.915, 0},
                     {1.920, 0},        {1.925, 0},        {1.930, 0},        {1.935, 0},
                     {1.940, 0},        {1.945, 0},        {1.950, 0},        {1.955, 0},
                     {1.960, 0},        {1.965, 0},        {1.970, 0},        {1.975, 0},
                     {1.980, 0},        {1.985, 0},        {1.990, 0},        {1.995, 0},
                     {2.000, 0},        {2.005, 0},        {2.010, 0},        {2.015, 0},
                     {2.020, 0},        {2.025, 0},        {2.030, 0},        {2.035, 0},
                     {2.040, 0},        {2.045, 0},        {2.050, 0},        {2.055, 0},
                     {2.060, 0},        {2.065, 0},        {2.070, 0},        {2.075, 0},
                     {2.080, 0},        {2.085, 0},        {2.090, 0},        {2.095, 0},
                     {2.100, 0},        {2.105, 0},        {2.110, 0},        {2.115, 0},
                     {2.120, 0},        {2.125, 0},        {2.130, 0},        {2.135, 0},
                     {2.140, 0},        {2.145, 0},        {2.150, 0},        {2.155, 0},
                     {2.160, 0},        {2.165, 0},        {2.170, 0},        {2.175, 0},
                     {2.180, 0},        {2.185, 0},        {2.190, 0},        {2.195, 0},
                     {2.200, 0},        {2.205, 0},        {2.210, 0},        {2.215, 0},
                     {2.220, 0},        {2.225, 0},        {2.230, 0},        {2.235, 0},
                     {2.240, 0},        {2.245, 0},        {2.250, 0},        {2.255, 0},
                     {2.260, 0},        {2.265, 0},        {2.270, 0},        {2.275, 0},
                     {2.280, 0},        {2.285, 0},        {2.290, 0},        {2.295, 0},
                     {2.300, 0},        {2.305, 0},        {2.310, 0},        {2.315, 0},
                     {2.320, 0},        {2.325, 0},        {2.330, 0},        {2.335, 0},
                     {2.340, 0},        {2.345, 0},        {2.350, 0},        {2.355, 0},
                     {2.360, 0},        {2.365, 0},        {2.370, 0},        {2.375, 0},
                     {2.380, 0},        {2.385, 0},        {2.390, 0},        {2.395, 0},
                     {2.400, 0},        {2.405, 0},        {2.410, 0},        {2.415, 0},
                     {2.420, 0},        {2.425, 0},        {2.430, 0},        {2.435, 0},
                     {2.440, 0},        {2.445, 0},        {2.450, 0},        {2.455, 0},
                     {2.460, 0},        {2.465, 0},        {2.470, 0},        {2.475, 0},
                     {2.480, 0},        {2.485, 0},        {2.490, 0},        {2.495, 0},
                     {2.500, 0}});

        return eqe;
    }

    static SingleLayerOptics::PVPowerPropertiesTable table()
    {
        return {{{0.002478752, 0.550933333, 0.5467},
                 {0.002605841, 0.552778333, 0.5467415},
                 {0.002739445, 0.554623333, 0.546772667},
                 {0.002879899, 0.556468333, 0.5467935},
                 {0.003027555, 0.558313333, 0.546804},
                 {0.003182781, 0.560158333, 0.546804167},
                 {0.003345965, 0.562003333, 0.546794},
                 {0.003517517, 0.563848333, 0.5467735},
                 {0.003697864, 0.565693333, 0.546742667},
                 {0.003887457, 0.567538333, 0.5467015},
                 {0.004086771, 0.569383333, 0.54665},
                 {0.004296305, 0.571228333, 0.546588167},
                 {0.004516581, 0.573073333, 0.546516},
                 {0.004748151, 0.574918333, 0.5464335},
                 {0.004991594, 0.576763333, 0.546340667},
                 {0.005247518, 0.578608333, 0.5462375},
                 {0.005516564, 0.580453333, 0.546124},
                 {0.005799405, 0.582298333, 0.546000167},
                 {0.006096747, 0.584143333, 0.545866},
                 {0.006409333, 0.585988333, 0.5457215},
                 {0.006737947, 0.587833333, 0.545566667},
                 {0.007083409, 0.589678333, 0.5454015},
                 {0.007446583, 0.591523333, 0.545226},
                 {0.007828378, 0.593368333, 0.545040167},
                 {0.008229747, 0.595213333, 0.544844},
                 {0.008651695, 0.597058333, 0.5446375},
                 {0.009095277, 0.598903333, 0.544420667},
                 {0.009561602, 0.600748333, 0.5441935},
                 {0.010051836, 0.602593333, 0.543956},
                 {0.010567204, 0.604438333, 0.543708167},
                 {0.011108997, 0.606283333, 0.54345},
                 {0.011678567, 0.608128333, 0.5431815},
                 {0.01227734, 0.609973333, 0.542902667},
                 {0.012906813, 0.611818333, 0.5426135},
                 {0.013568559, 0.613663333, 0.542314},
                 {0.014264234, 0.615508333, 0.542004167},
                 {0.014995577, 0.617353333, 0.541684},
                 {0.015764416, 0.619198333, 0.5413535},
                 {0.016572675, 0.621043333, 0.541012667},
                 {0.017422375, 0.622888333, 0.5406615},
                 {0.018315639, 0.624733333, 0.5403},
                 {0.019254702, 0.626578333, 0.539928167},
                 {0.020241911, 0.628423333, 0.539546},
                 {0.021279736, 0.630268333, 0.5391535},
                 {0.022370772, 0.632113333, 0.538750667},
                 {0.023517746, 0.633958333, 0.5383375},
                 {0.024723526, 0.635803333, 0.537914},
                 {0.025991129, 0.637648333, 0.537480167},
                 {0.027323722, 0.639493333, 0.537036},
                 {0.02872464, 0.641338333, 0.5365815},
                 {0.030197383, 0.643183333, 0.536116667},
                 {0.031745636, 0.645028333, 0.5356415},
                 {0.03337327, 0.646873333, 0.535156},
                 {0.035084354, 0.648718333, 0.534660167},
                 {0.036883167, 0.650563333, 0.534154},
                 {0.038774208, 0.652408333, 0.5336375},
                 {0.040762204, 0.654253333, 0.533110667},
                 {0.042852127, 0.656098333, 0.5325735},
                 {0.045049202, 0.657943333, 0.532026},
                 {0.047358924, 0.659788333, 0.531468167},
                 {0.049787068, 0.661633333, 0.5309},
                 {0.052339706, 0.663478333, 0.5303215},
                 {0.05502322, 0.665323333, 0.529732667},
                 {0.057844321, 0.667168333, 0.5291335},
                 {0.060810063, 0.669013333, 0.528524},
                 {0.063927861, 0.670858333, 0.527904167},
                 {0.067205513, 0.672703333, 0.527274},
                 {0.070651213, 0.674548333, 0.5266335},
                 {0.074273578, 0.676393333, 0.525982667},
                 {0.078081666, 0.678238333, 0.5253215},
                 {0.082084999, 0.680083333, 0.52465},
                 {0.086293586, 0.681928333, 0.523968167},
                 {0.090717953, 0.683773333, 0.523276},
                 {0.095369162, 0.685618333, 0.5225735},
                 {0.100258844, 0.687463333, 0.521860667},
                 {0.105399225, 0.689308333, 0.5211375},
                 {0.110803158, 0.691153333, 0.520404},
                 {0.116484158, 0.692998333, 0.519660167},
                 {0.122456428, 0.694843333, 0.518906},
                 {0.128734904, 0.696688333, 0.5181415},
                 {0.135335283, 0.698533333, 0.517366667},
                 {0.142274072, 0.700378333, 0.5165815},
                 {0.149568619, 0.702223333, 0.515786},
                 {0.157237166, 0.704068333, 0.514980167},
                 {0.165298888, 0.705913333, 0.514164},
                 {0.173773943, 0.707758333, 0.5133375},
                 {0.182683524, 0.709603333, 0.512500667},
                 {0.192049909, 0.711448333, 0.5116535},
                 {0.201896518, 0.713293333, 0.510796},
                 {0.212247974, 0.715138333, 0.509928167},
                 {0.22313016, 0.716983333, 0.50905},
                 {0.234570288, 0.718828333, 0.5081615},
                 {0.246596964, 0.720673333, 0.507262667},
                 {0.259240261, 0.722518333, 0.5063535},
                 {0.272531793, 0.724363333, 0.505434},
                 {0.286504797, 0.726208333, 0.504504167},
                 {0.301194212, 0.728053333, 0.503564},
                 {0.316636769, 0.729898333, 0.5026135},
                 {0.332871084, 0.731743333, 0.501652667},
                 {0.349937749, 0.733588333, 0.5006815},
                 {0.367879441, 0.735433333, 0.4997},
                 {0.386741023, 0.737278333, 0.498708167},
                 {0.40656966, 0.739123333, 0.497706},
                 {0.427414932, 0.740968333, 0.4966935},
                 {0.449328964, 0.742813333, 0.495670667},
                 {0.472366553, 0.744658333, 0.4946375},
                 {0.496585304, 0.746503333, 0.493594},
                 {0.522045777, 0.748348333, 0.492540167},
                 {0.548811636, 0.750193333, 0.491476},
                 {0.57694981, 0.752038333, 0.4904015},
                 {0.60653066, 0.753883333, 0.489316667},
                 {0.637628152, 0.755728333, 0.4882215},
                 {0.670320046, 0.757573333, 0.487116},
                 {0.70468809, 0.759418333, 0.486000167},
                 {0.740818221, 0.761263333, 0.484874},
                 {0.778800783, 0.763108333, 0.4837375},
                 {0.818730753, 0.764953333, 0.482590667},
                 {0.860707976, 0.766798333, 0.4814335},
                 {0.904837418, 0.768643333, 0.480266},
                 {0.951229425, 0.770488333, 0.479088167},
                 {1, 0.772333333, 0.4779},
                 {1.051271096, 0.774178333, 0.4767015},
                 {1.105170918, 0.776023333, 0.475492667},
                 {1.161834243, 0.777868333, 0.4742735},
                 {1.221402758, 0.779713333, 0.473044},
                 {1.284025417, 0.781558333, 0.471804167},
                 {1.349858808, 0.783403333, 0.470554},
                 {1.419067549, 0.785248333, 0.4692935},
                 {1.491824698, 0.787093333, 0.468022667},
                 {1.568312185, 0.788938333, 0.4667415},
                 {1.648721271, 0.790783333, 0.46545},
                 {1.733253018, 0.792628333, 0.464148167},
                 {1.8221188, 0.794473333, 0.462836},
                 {1.915540829, 0.796318333, 0.4615135},
                 {2.013752707, 0.798163333, 0.460180667},
                 {2.117000017, 0.800008333, 0.4588375},
                 {2.225540928, 0.801853333, 0.457484},
                 {2.339646852, 0.803698333, 0.456120167},
                 {2.459603111, 0.805543333, 0.454746},
                 {2.585709659, 0.807388333, 0.4533615},
                 {2.718281828, 0.809233333, 0.451966667},
                 {2.857651118, 0.811078333, 0.4505615},
                 {3.004166024, 0.812923333, 0.449146},
                 {3.15819291, 0.814768333, 0.447720167},
                 {3.320116923, 0.816613333, 0.446284},
                 {3.490342957, 0.818458333, 0.4448375},
                 {3.669296668, 0.820303333, 0.443380667},
                 {3.857425531, 0.822148333, 0.4419135},
                 {4.055199967, 0.823993333, 0.440436},
                 {4.263114515, 0.825838333, 0.438948167},
                 {4.48168907, 0.827683333, 0.43745},
                 {4.711470183, 0.829528333, 0.4359415},
                 {4.953032424, 0.831373333, 0.434422667},
                 {5.206979827, 0.833218333, 0.4328935},
                 {5.473947392, 0.835063333, 0.431354},
                 {5.754602676, 0.836908333, 0.429804167},
                 {6.049647464, 0.838753333, 0.428244},
                 {6.359819523, 0.840598333, 0.4266735},
                 {6.685894442, 0.842443333, 0.425092667},
                 {7.028687581, 0.844288333, 0.4235015},
                 {7.389056099, 0.846133333, 0.4219}}};
    }


protected:
    virtual void SetUp()
    {
        const auto aSolarRadiation = loadSolarRadiationFile();
        auto pvSample = std::make_shared<SpectralAveraging::PhotovoltaicSampleData>(
          *loadSampleData_NFRC_102(), eqeFront(), eqeBack());

        const auto commonWL{aSolarRadiation.getXArray()};

        double thickness = 3.048e-3;   // [m]
        const auto aMaterial_1 =
          Material::nBandPhotovoltaicMaterial(pvSample,
                                              thickness,
                                              FenestrationCommon::MaterialType::Monolithic,
                                              FenestrationCommon::WavelengthRange::Solar);

        aMaterial_1->setBandWavelengths(commonWL);

        const auto layer1 = SingleLayerOptics::PhotovoltaicSpecularLayer::createLayer(aMaterial_1, table());

        m_Layer = CMultiPaneSpecular::create({layer1}, loadSolarRadiationFile());
    }

public:
    [[nodiscard]] CMultiPaneSpecular & getLayer() const
    {
        return *m_Layer;
    }
};

TEST_F(Photovoltaic_DoublePane_Example2, Test1)
{
    SCOPED_TRACE("Begin Test: Double pane photovoltaic - Example 1.");

    constexpr double angle{0.0};
    constexpr double minLambda{0.3};
    constexpr double maxLambda{2.5};

    auto aLayer = getLayer();

    const double T =
      aLayer.getPropertySimple(PropertySimple::T, Side::Front, Scattering::DirectDirect, angle, 0);
    EXPECT_NEAR(0.833849, T, 1e-6);

    const double abs1 = aLayer.Abs(1, angle, minLambda, maxLambda);
    EXPECT_NEAR(0.091386, abs1, 1e-6);

    const double absHeat = aLayer.AbsHeat(1, angle, minLambda, maxLambda);
    EXPECT_NEAR(0.077666, absHeat, 1e-6);

    const double absEl1 = aLayer.AbsElectricity(1, angle, minLambda, maxLambda);
    EXPECT_NEAR(0.01372, absEl1, 1e-6);
}