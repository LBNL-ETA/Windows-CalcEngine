#include <memory>
#include <gtest/gtest.h>

#include "WCESpectralAveraging.hpp"
#include "WCEMultiLayerOptics.hpp"
#include "WCESingleLayerOptics.hpp"
#include "WCECommon.hpp"

using FenestrationCommon::CSeries;
using FenestrationCommon::PropertySimple;
using FenestrationCommon::Side;
using FenestrationCommon::Scattering;
using SpectralAveraging::CSpectralSampleData;
using SingleLayerOptics::Material;
using MultiLayerOptics::CMultiPaneSpecular;

class Photovoltaic_DoublePane_Example1 : public testing::Test
{
private:
    std::unique_ptr<CMultiPaneSpecular> m_Layer;

    static CSeries loadSolarRadiationFile()
    {
        // Full ASTM E891-87 Table 1 (Solar radiation)
        CSeries aSolarRadiation(
          {{0.3000, 0.0},    {0.3050, 3.4},    {0.3100, 15.6},   {0.3150, 41.1},   {0.3200, 71.2},
           {0.3250, 100.2},  {0.3300, 152.4},  {0.3350, 155.6},  {0.3400, 179.4},  {0.3450, 186.7},
           {0.3500, 212.0},  {0.3600, 240.5},  {0.3700, 324.0},  {0.3800, 362.4},  {0.3900, 381.7},
           {0.4000, 556.0},  {0.4100, 656.3},  {0.4200, 690.8},  {0.4300, 641.9},  {0.4400, 798.5},
           {0.4500, 956.6},  {0.4600, 990.0},  {0.4700, 998.0},  {0.4800, 1046.1}, {0.4900, 1005.1},
           {0.5000, 1026.7}, {0.5100, 1066.7}, {0.5200, 1011.5}, {0.5300, 1084.9}, {0.5400, 1082.4},
           {0.5500, 1102.2}, {0.5700, 1087.4}, {0.5900, 1024.3}, {0.6100, 1088.8}, {0.6300, 1062.1},
           {0.6500, 1061.7}, {0.6700, 1046.2}, {0.6900, 859.2},  {0.7100, 1002.4}, {0.7180, 816.9},
           {0.7244, 842.8},  {0.7400, 971.0},  {0.7525, 956.3},  {0.7575, 942.2},  {0.7625, 524.8},
           {0.7675, 830.7},  {0.7800, 908.9},  {0.8000, 873.4},  {0.8160, 712.0},  {0.8237, 660.2},
           {0.8315, 765.5},  {0.8400, 799.8},  {0.8600, 815.2},  {0.8800, 778.3},  {0.9050, 630.4},
           {0.9150, 565.2},  {0.9250, 586.4},  {0.9300, 348.1},  {0.9370, 224.2},  {0.9480, 271.4},
           {0.9650, 451.2},  {0.9800, 549.7},  {0.9935, 630.1},  {1.0400, 582.9},  {1.0700, 539.7},
           {1.1000, 366.2},  {1.1200, 98.1},   {1.1300, 169.5},  {1.1370, 118.7},  {1.1610, 301.9},
           {1.1800, 406.8},  {1.2000, 375.2},  {1.2350, 423.6},  {1.2900, 365.7},  {1.3200, 223.4},
           {1.3500, 30.1},   {1.3950, 1.4},    {1.4425, 51.6},   {1.4625, 97.0},   {1.4770, 97.3},
           {1.4970, 167.1},  {1.5200, 239.3},  {1.5390, 248.8},  {1.5580, 249.3},  {1.5780, 222.3},
           {1.5920, 227.3},  {1.6100, 210.5},  {1.6300, 224.7},  {1.6460, 215.9},  {1.6780, 202.8},
           {1.7400, 158.2},  {1.8000, 28.6},   {1.8600, 1.8},    {1.9200, 1.1},    {1.9600, 19.7},
           {1.9850, 84.9},   {2.0050, 25.0},   {2.0350, 92.5},   {2.0650, 56.3},   {2.1000, 82.7},
           {2.1480, 76.2},   {2.1980, 66.4},   {2.2700, 65.0},   {2.3600, 57.6},   {2.4500, 19.8},
           {2.4940, 17.0},   {2.5370, 3.0},    {2.9410, 4.0},    {2.9730, 7.0},    {3.0050, 6.0},
           {3.0560, 3.0},    {3.1320, 5.0},    {3.1560, 18.0},   {3.2040, 1.2},    {3.2450, 3.0},
           {3.3170, 12.0},   {3.3440, 3.0},    {3.4500, 12.2},   {3.5730, 11.0},   {3.7650, 9.0},
           {4.0450, 6.9}

          });

        return aSolarRadiation;
    }

    [[nodiscard]] std::shared_ptr<CSpectralSampleData> loadSampleData_1() const
    {
        return CSpectralSampleData::create({{0.3, 0.2, 0.029467085, 0.023573668},
                                            {0.305, 0.2, 0.035386165, 0.028308932},
                                            {0.31, 0.2, 0.044138065, 0.035310452},
                                            {0.315, 0.2, 0.057896758, 0.046317406},
                                            {0.32, 0.2, 0.074693366, 0.059754693},
                                            {0.325, 0.2, 0.09201916, 0.073615328},
                                            {0.33, 0.2, 0.110691408, 0.088553127},
                                            {0.335, 0.2, 0.127378724, 0.101902979},
                                            {0.34, 0.2, 0.143470987, 0.11477679},
                                            {0.345, 0.2, 0.1572673, 0.12581384},
                                            {0.35, 0.2, 0.140955643, 0.112764515},
                                            {0.355, 0.2, 0.169708917, 0.135767133},
                                            {0.36, 0.2, 0.182848324, 0.146278659},
                                            {0.365, 0.2, 0.176171099, 0.140936879},
                                            {0.37, 0.2, 0.170570901, 0.13645672},
                                            {0.375, 0.2, 0.165761075, 0.13260886},
                                            {0.38, 0.2, 0.161807, 0.1294456},
                                            {0.385, 0.2, 0.158328853, 0.126663082},
                                            {0.39, 0.2, 0.155387715, 0.124310172},
                                            {0.395, 0.2, 0.152947089, 0.122357671},
                                            {0.4, 0.2, 0.151081167, 0.120864934},
                                            {0.405, 0.2, 0.129577421, 0.103661937},
                                            {0.41, 0.2, 0.105516631, 0.084413305},
                                            {0.415, 0.2, 0.088646837, 0.070917469},
                                            {0.42, 0.2, 0.074761262, 0.05980901},
                                            {0.425, 0.2, 0.060598288, 0.04847863},
                                            {0.43, 0.2, 0.049271261, 0.039417009},
                                            {0.435, 0.2, 0.041697987, 0.033358389},
                                            {0.44, 0.2, 0.035389454, 0.028311563},
                                            {0.445, 0.2, 0.029166618, 0.023333295},
                                            {0.45, 0.2, 0.02366259, 0.018930072},
                                            {0.455, 0.2, 0.019256622, 0.015405297},
                                            {0.46, 0.2, 0.01508154, 0.012065232},
                                            {0.465, 0.2, 0.010958859, 0.008767087},
                                            {0.47, 0.2, 0.007267178, 0.005813742},
                                            {0.475, 0.2, 0.005628687, 0.00450295},
                                            {0.48, 0.2, 0.004370733, 0.003496586},
                                            {0.485, 0.2, 0.003034438, 0.00242755},
                                            {0.49, 0.2, 0.002053996, 0.001643197},
                                            {0.495, 0.2, 0.00316348, 0.002530784},
                                            {0.5, 0.2, 0.004255169, 0.003404135},
                                            {0.505, 0.2, 0.004829087, 0.00386327},
                                            {0.51, 0.2, 0.006744613, 0.005395691},
                                            {0.515, 0.2, 0.008275007, 0.006620005},
                                            {0.52, 0.2, 0.010055935, 0.008044748},
                                            {0.525, 0.2, 0.012698541, 0.010158833},
                                            {0.53, 0.2, 0.013308763, 0.01064701},
                                            {0.535, 0.2, 0.013054157, 0.010443326},
                                            {0.54, 0.2, 0.01169837, 0.009358696},
                                            {0.545, 0.2, 0.010662868, 0.008530294},
                                            {0.55, 0.2, 0.009982928, 0.007986343},
                                            {0.555, 0.2, 0.009654542, 0.007723633},
                                            {0.56, 0.2, 0.008516421, 0.006813137},
                                            {0.565, 0.2, 0.006867543, 0.005494034},
                                            {0.57, 0.2, 0.005691355, 0.004553084},
                                            {0.575, 0.2, 0.005064552, 0.004051641},
                                            {0.58, 0.2, 0.004223259, 0.003378607},
                                            {0.585, 0.2, 0.003044859, 0.002435887},
                                            {0.59, 0.2, 0.002788906, 0.002231125},
                                            {0.595, 0.2, 0.002728052, 0.002182442},
                                            {0.6, 0.2, 0.002969925, 0.00237594},
                                            {0.605, 0.2, 0.003234363, 0.002587491},
                                            {0.61, 0.2, 0.003169668, 0.002535735},
                                            {0.615, 0.2, 0.003135889, 0.002508711},
                                            {0.62, 0.2, 0.003135889, 0.002508711},
                                            {0.625, 0.2, 0.003135889, 0.002508711},
                                            {0.63, 0.2, 0.003135889, 0.002508711},
                                            {0.635, 0.2, 0.003135889, 0.002508711},
                                            {0.64, 0.2, 0.003135889, 0.002508711},
                                            {0.645, 0.2, 0.003135889, 0.002508711},
                                            {0.65, 0.2, 0.003135889, 0.002508711},
                                            {0.655, 0.2, 0.003135889, 0.002508711},
                                            {0.66, 0.2, 0.003135889, 0.002508711},
                                            {0.665, 0.2, 0.003135889, 0.002508711},
                                            {0.67, 0.2, 0.003135889, 0.002508711},
                                            {0.675, 0.2, 0.003135889, 0.002508711},
                                            {0.68, 0.2, 0.003135889, 0.002508711},
                                            {0.685, 0.2, 0.003135889, 0.002508711},
                                            {0.69, 0.2, 0.003135889, 0.002508711},
                                            {0.695, 0.2, 0.003135889, 0.002508711},
                                            {0.7, 0.2, 0.003135889, 0.002508711},
                                            {0.705, 0.2, 0.003135889, 0.002508711},
                                            {0.71, 0.2, 0.003135889, 0.002508711},
                                            {0.715, 0.2, 0.003135889, 0.002508711},
                                            {0.72, 0.2, 0.003135889, 0.002508711},
                                            {0.725, 0.2, 0.003135889, 0.002508711},
                                            {0.73, 0.2, 0.003122737, 0.00249819},
                                            {0.735, 0.2, 0.003065996, 0.002452797},
                                            {0.74, 0.2, 0.003018268, 0.002414614},
                                            {0.745, 0.2, 0.003155416, 0.002524333},
                                            {0.75, 0.2, 0.003463547, 0.002770838},
                                            {0.755, 0.2, 0.003268507, 0.002614806},
                                            {0.76, 0.2, 0.002937871, 0.002350297},
                                            {0.765, 0.2, 0.004063018, 0.003250414},
                                            {0.77, 0.2, 0.005142101, 0.004113681},
                                            {0.775, 0.2, 0.005369343, 0.004295475},
                                            {0.78, 0.2, 0.005673375, 0.0045387},
                                            {0.785, 0.2, 0.006152574, 0.004922059},
                                            {0.79, 0.2, 0.006671621, 0.005337297},
                                            {0.795, 0.2, 0.007232792, 0.005786234},
                                            {0.8, 0.2, 0.007800639, 0.006240511},
                                            {0.805, 0.2, 0.008339716, 0.006671773},
                                            {0.81, 0.2, 0.008824299, 0.007059439},
                                            {0.815, 0.2, 0.009277106, 0.007421685},
                                            {0.82, 0.2, 0.009673157, 0.007738526},
                                            {0.825, 0.2, 0.00996418, 0.007971344},
                                            {0.83, 0.2, 0.010329176, 0.008263341},
                                            {0.835, 0.2, 0.011096561, 0.008877249},
                                            {0.84, 0.2, 0.011311481, 0.009049185},
                                            {0.845, 0.2, 0.011311481, 0.009049185},
                                            {0.85, 0.2, 0.011473822, 0.009179058},
                                            {0.855, 0.2, 0.011847285, 0.009477828},
                                            {0.86, 0.2, 0.01185652, 0.009485216},
                                            {0.865, 0.2, 0.011984378, 0.009587503},
                                            {0.87, 0.2, 0.012561146, 0.010048917},
                                            {0.875, 0.2, 0.013358412, 0.010686729},
                                            {0.88, 0.2, 0.014104263, 0.01128341},
                                            {0.885, 0.2, 0.01466208, 0.011729664},
                                            {0.89, 0.2, 0.015099032, 0.012079226},
                                            {0.895, 0.2, 0.015126757, 0.012101406},
                                            {0.9, 0.2, 0.01513075, 0.0121046},
                                            {0.905, 0.2, 0.015380561, 0.012304448},
                                            {0.91, 0.2, 0.015909614, 0.012727691},
                                            {0.915, 0.2, 0.01656497, 0.013251976},
                                            {0.92, 0.2, 0.017193688, 0.013754951},
                                            {0.925, 0.2, 0.017645814, 0.014116651},
                                            {0.93, 0.2, 0.017951175, 0.01436094},
                                            {0.935, 0.2, 0.018440106, 0.014752085},
                                            {0.94, 0.2, 0.019175994, 0.015340795},
                                            {0.945, 0.2, 0.019373883, 0.015499106},
                                            {0.95, 0.2, 0.019470914, 0.015576731},
                                            {0.955, 0.2, 0.01991279, 0.015930232},
                                            {0.96, 0.2, 0.020480314, 0.016384252},
                                            {0.965, 0.2, 0.020836353, 0.016669083},
                                            {0.97, 0.2, 0.021206428, 0.016965143},
                                            {0.975, 0.2, 0.021648406, 0.017318725},
                                            {0.98, 0.2, 0.022400592, 0.017920473},
                                            {0.985, 0.2, 0.02318883, 0.018551064},
                                            {0.99, 0.2, 0.023559352, 0.018847481},
                                            {0.995, 0.2, 0.023845539, 0.019076431},
                                            {1, 0.2, 0.024323549, 0.019458839},
                                            {1.005, 0.2, 0.024689397, 0.019751517},
                                            {1.01, 0.2, 0.024866528, 0.019893222},
                                            {1.015, 0.2, 0.024975157, 0.019980125},
                                            {1.02, 0.2, 0.025043666, 0.020034933},
                                            {1.025, 0.2, 0.025399824, 0.020319859},
                                            {1.03, 0.2, 0.026194281, 0.020955425},
                                            {1.035, 0.2, 0.02667816, 0.021342528},
                                            {1.04, 0.2, 0.027169382, 0.021735506},
                                            {1.045, 0.2, 0.028007538, 0.022406031},
                                            {1.05, 0.2, 0.028761424, 0.023009139},
                                            {1.055, 0.2, 0.029128198, 0.023302559},
                                            {1.06, 0.2, 0.029538485, 0.023630788},
                                            {1.065, 0.2, 0.0300107, 0.02400856},
                                            {1.07, 0.2, 0.030219186, 0.024175349},
                                            {1.075, 0.2, 0.030377194, 0.024301755},
                                            {1.08, 0.2, 0.030767864, 0.024614291},
                                            {1.085, 0.2, 0.031261651, 0.025009321},
                                            {1.09, 0.2, 0.031757035, 0.025405628},
                                            {1.095, 0.2, 0.032157399, 0.025725919},
                                            {1.1, 0.2, 0.032456845, 0.025965476},
                                            {1.105, 0.2, 0.032880379, 0.026304303},
                                            {1.11, 0.2, 0.033453893, 0.026763115},
                                            {1.115, 0.2, 0.034105768, 0.027284615},
                                            {1.12, 0.2, 0.034764421, 0.027811537},
                                            {1.125, 0.2, 0.035358271, 0.028286617},
                                            {1.13, 0.2, 0.035815734, 0.028652587},
                                            {1.135, 0.2, 0.036108562, 0.02888685},
                                            {1.14, 0.2, 0.036383639, 0.029106911},
                                            {1.145, 0.2, 0.036758744, 0.029406995},
                                            {1.15, 0.2, 0.036977694, 0.029582155},
                                            {1.155, 0.2, 0.037065034, 0.029652027},
                                            {1.16, 0.2, 0.037521382, 0.030017105},
                                            {1.165, 0.2, 0.038424915, 0.030739932},
                                            {1.17, 0.2, 0.037976244, 0.030380995},
                                            {1.175, 0.2, 0.037422084, 0.029937667},
                                            {1.18, 0.2, 0.03712203, 0.029697624},
                                            {1.185, 0.2, 0.03699078, 0.029592624},
                                            {1.19, 0.2, 0.036990596, 0.029592477},
                                            {1.195, 0.2, 0.036990596, 0.029592477},
                                            {1.2, 0.2, 0.036990596, 0.029592477},
                                            {1.205, 0.2, 0.037, 0.0296},
                                            {1.21, 0.2, 0.037, 0.0296},
                                            {1.215, 0.2, 0.037, 0.0296},
                                            {1.22, 0.2, 0.037, 0.0296},
                                            {1.225, 0.2, 0.037, 0.0296},
                                            {1.23, 0.2, 0.037, 0.0296},
                                            {1.235, 0.2, 0.037, 0.0296},
                                            {1.24, 0.2, 0.037, 0.0296},
                                            {1.245, 0.2, 0.037, 0.0296},
                                            {1.25, 0.2, 0.037, 0.0296},
                                            {1.255, 0.2, 0.037, 0.0296},
                                            {1.26, 0.2, 0.037, 0.0296},
                                            {1.265, 0.2, 0.037, 0.0296},
                                            {1.27, 0.2, 0.037, 0.0296},
                                            {1.275, 0.2, 0.037, 0.0296},
                                            {1.28, 0.2, 0.037, 0.0296},
                                            {1.285, 0.2, 0.037, 0.0296},
                                            {1.29, 0.2, 0.037, 0.0296},
                                            {1.295, 0.2, 0.037, 0.0296},
                                            {1.3, 0.2, 0.037, 0.0296},
                                            {1.305, 0.2, 0.037, 0.0296},
                                            {1.31, 0.2, 0.037, 0.0296},
                                            {1.315, 0.2, 0.037, 0.0296},
                                            {1.32, 0.2, 0.037, 0.0296},
                                            {1.325, 0.2, 0.037, 0.0296},
                                            {1.33, 0.2, 0.037, 0.0296},
                                            {1.335, 0.2, 0.037, 0.0296},
                                            {1.34, 0.2, 0.037, 0.0296},
                                            {1.345, 0.2, 0.037, 0.0296},
                                            {1.35, 0.2, 0.037, 0.0296},
                                            {1.355, 0.2, 0.037, 0.0296},
                                            {1.36, 0.2, 0.037, 0.0296},
                                            {1.365, 0.2, 0.037, 0.0296},
                                            {1.37, 0.2, 0.037, 0.0296},
                                            {1.375, 0.2, 0.037, 0.0296},
                                            {1.38, 0.2, 0.037, 0.0296},
                                            {1.385, 0.2, 0.037, 0.0296},
                                            {1.39, 0.2, 0.037, 0.0296},
                                            {1.395, 0.2, 0.037, 0.0296},
                                            {1.4, 0.2, 0.037, 0.0296},
                                            {1.405, 0.2, 0.037, 0.0296},
                                            {1.41, 0.2, 0.037, 0.0296},
                                            {1.415, 0.2, 0.037, 0.0296},
                                            {1.42, 0.2, 0.037, 0.0296},
                                            {1.425, 0.2, 0.037, 0.0296},
                                            {1.43, 0.2, 0.037, 0.0296},
                                            {1.435, 0.2, 0.037, 0.0296},
                                            {1.44, 0.2, 0.037, 0.0296},
                                            {1.445, 0.2, 0.037, 0.0296},
                                            {1.45, 0.2, 0.037, 0.0296},
                                            {1.455, 0.2, 0.037, 0.0296},
                                            {1.46, 0.2, 0.037, 0.0296},
                                            {1.465, 0.2, 0.037, 0.0296},
                                            {1.47, 0.2, 0.037, 0.0296},
                                            {1.475, 0.2, 0.037, 0.0296},
                                            {1.48, 0.2, 0.037, 0.0296},
                                            {1.485, 0.2, 0.037, 0.0296},
                                            {1.49, 0.2, 0.037, 0.0296},
                                            {1.495, 0.2, 0.037, 0.0296},
                                            {1.5, 0.2, 0.037, 0.0296},
                                            {1.505, 0.2, 0.037, 0.0296},
                                            {1.51, 0.2, 0.037, 0.0296},
                                            {1.515, 0.2, 0.037, 0.0296},
                                            {1.52, 0.2, 0.037, 0.0296},
                                            {1.525, 0.2, 0.037, 0.0296},
                                            {1.53, 0.2, 0.037, 0.0296},
                                            {1.535, 0.2, 0.037, 0.0296},
                                            {1.54, 0.2, 0.037, 0.0296},
                                            {1.545, 0.2, 0.037, 0.0296},
                                            {1.55, 0.2, 0.037, 0.0296},
                                            {1.555, 0.2, 0.037, 0.0296},
                                            {1.56, 0.2, 0.037, 0.0296},
                                            {1.565, 0.2, 0.037, 0.0296},
                                            {1.57, 0.2, 0.037, 0.0296},
                                            {1.575, 0.2, 0.037, 0.0296},
                                            {1.58, 0.2, 0.037, 0.0296},
                                            {1.585, 0.2, 0.037, 0.0296},
                                            {1.59, 0.2, 0.037, 0.0296},
                                            {1.595, 0.2, 0.037, 0.0296},
                                            {1.6, 0.2, 0.037, 0.0296},
                                            {1.605, 0.2, 0.037, 0.0296},
                                            {1.61, 0.2, 0.037, 0.0296},
                                            {1.615, 0.2, 0.037, 0.0296},
                                            {1.62, 0.2, 0.037, 0.0296},
                                            {1.625, 0.2, 0.037, 0.0296},
                                            {1.63, 0.2, 0.037, 0.0296},
                                            {1.635, 0.2, 0.037, 0.0296},
                                            {1.64, 0.2, 0.037, 0.0296},
                                            {1.645, 0.2, 0.037, 0.0296},
                                            {1.65, 0.2, 0.037, 0.0296},
                                            {1.655, 0.2, 0.037, 0.0296},
                                            {1.66, 0.2, 0.037, 0.0296},
                                            {1.665, 0.2, 0.037, 0.0296},
                                            {1.67, 0.2, 0.037, 0.0296},
                                            {1.675, 0.2, 0.037, 0.0296},
                                            {1.68, 0.2, 0.037, 0.0296},
                                            {1.685, 0.2, 0.037, 0.0296},
                                            {1.69, 0.2, 0.037, 0.0296},
                                            {1.695, 0.2, 0.037, 0.0296},
                                            {1.7, 0.2, 0.037, 0.0296},
                                            {1.705, 0.2, 0.037, 0.0296},
                                            {1.71, 0.2, 0.037, 0.0296},
                                            {1.715, 0.2, 0.037, 0.0296},
                                            {1.72, 0.2, 0.037, 0.0296},
                                            {1.725, 0.2, 0.037, 0.0296},
                                            {1.73, 0.2, 0.037, 0.0296},
                                            {1.735, 0.2, 0.037, 0.0296},
                                            {1.74, 0.2, 0.037, 0.0296},
                                            {1.745, 0.2, 0.037, 0.0296},
                                            {1.75, 0.2, 0.037, 0.0296},
                                            {1.755, 0.2, 0.037, 0.0296},
                                            {1.76, 0.2, 0.037, 0.0296},
                                            {1.765, 0.2, 0.037, 0.0296},
                                            {1.77, 0.2, 0.037, 0.0296},
                                            {1.775, 0.2, 0.037, 0.0296},
                                            {1.78, 0.2, 0.037, 0.0296},
                                            {1.785, 0.2, 0.037, 0.0296},
                                            {1.79, 0.2, 0.037, 0.0296},
                                            {1.795, 0.2, 0.037, 0.0296},
                                            {1.8, 0.2, 0.037, 0.0296},
                                            {1.805, 0.2, 0.037, 0.0296},
                                            {1.81, 0.2, 0.037, 0.0296},
                                            {1.815, 0.2, 0.037, 0.0296},
                                            {1.82, 0.2, 0.037, 0.0296},
                                            {1.825, 0.2, 0.037, 0.0296},
                                            {1.83, 0.2, 0.037, 0.0296},
                                            {1.835, 0.2, 0.037, 0.0296},
                                            {1.84, 0.2, 0.037, 0.0296},
                                            {1.845, 0.2, 0.037, 0.0296},
                                            {1.85, 0.2, 0.037, 0.0296},
                                            {1.855, 0.2, 0.037, 0.0296},
                                            {1.86, 0.2, 0.037, 0.0296},
                                            {1.865, 0.2, 0.037, 0.0296},
                                            {1.87, 0.2, 0.037, 0.0296},
                                            {1.875, 0.2, 0.037, 0.0296},
                                            {1.88, 0.2, 0.037, 0.0296},
                                            {1.885, 0.2, 0.037, 0.0296},
                                            {1.89, 0.2, 0.037, 0.0296},
                                            {1.895, 0.2, 0.037, 0.0296},
                                            {1.9, 0.2, 0.037, 0.0296},
                                            {1.905, 0.2, 0.037, 0.0296},
                                            {1.91, 0.2, 0.037, 0.0296},
                                            {1.915, 0.2, 0.037, 0.0296},
                                            {1.92, 0.2, 0.037, 0.0296},
                                            {1.925, 0.2, 0.037, 0.0296},
                                            {1.93, 0.2, 0.037, 0.0296},
                                            {1.935, 0.2, 0.037, 0.0296},
                                            {1.94, 0.2, 0.037, 0.0296},
                                            {1.945, 0.2, 0.037, 0.0296},
                                            {1.95, 0.2, 0.037, 0.0296},
                                            {1.955, 0.2, 0.037, 0.0296},
                                            {1.96, 0.2, 0.037, 0.0296},
                                            {1.965, 0.2, 0.037, 0.0296},
                                            {1.97, 0.2, 0.037, 0.0296},
                                            {1.975, 0.2, 0.037, 0.0296},
                                            {1.98, 0.2, 0.037, 0.0296},
                                            {1.985, 0.2, 0.037, 0.0296},
                                            {1.99, 0.2, 0.037, 0.0296},
                                            {1.995, 0.2, 0.037, 0.0296},
                                            {2, 0.2, 0.037, 0.0296},
                                            {2.005, 0.2, 0.037, 0.0296},
                                            {2.01, 0.2, 0.037, 0.0296},
                                            {2.015, 0.2, 0.037, 0.0296},
                                            {2.02, 0.2, 0.037, 0.0296},
                                            {2.025, 0.2, 0.037, 0.0296},
                                            {2.03, 0.2, 0.037, 0.0296},
                                            {2.035, 0.2, 0.037, 0.0296},
                                            {2.04, 0.2, 0.037, 0.0296},
                                            {2.045, 0.2, 0.037, 0.0296},
                                            {2.05, 0.2, 0.037, 0.0296},
                                            {2.055, 0.2, 0.037, 0.0296},
                                            {2.06, 0.2, 0.037, 0.0296},
                                            {2.065, 0.2, 0.037, 0.0296},
                                            {2.07, 0.2, 0.037, 0.0296},
                                            {2.075, 0.2, 0.037, 0.0296},
                                            {2.08, 0.2, 0.037, 0.0296},
                                            {2.085, 0.2, 0.037, 0.0296},
                                            {2.09, 0.2, 0.037, 0.0296},
                                            {2.095, 0.2, 0.037, 0.0296},
                                            {2.1, 0.2, 0.037, 0.0296},
                                            {2.105, 0.2, 0.037, 0.0296},
                                            {2.11, 0.2, 0.037, 0.0296},
                                            {2.115, 0.2, 0.037, 0.0296},
                                            {2.12, 0.2, 0.037, 0.0296},
                                            {2.125, 0.2, 0.037, 0.0296},
                                            {2.13, 0.2, 0.037, 0.0296},
                                            {2.135, 0.2, 0.037, 0.0296},
                                            {2.14, 0.2, 0.037, 0.0296},
                                            {2.145, 0.2, 0.037, 0.0296},
                                            {2.15, 0.2, 0.037, 0.0296},
                                            {2.155, 0.2, 0.037, 0.0296},
                                            {2.16, 0.2, 0.037, 0.0296},
                                            {2.165, 0.2, 0.037, 0.0296},
                                            {2.17, 0.2, 0.037, 0.0296},
                                            {2.175, 0.2, 0.037, 0.0296},
                                            {2.18, 0.2, 0.037, 0.0296},
                                            {2.185, 0.2, 0.037, 0.0296},
                                            {2.19, 0.2, 0.037, 0.0296},
                                            {2.195, 0.2, 0.037, 0.0296},
                                            {2.2, 0.2, 0.037, 0.0296},
                                            {2.205, 0.2, 0.037, 0.0296},
                                            {2.21, 0.2, 0.037, 0.0296},
                                            {2.215, 0.2, 0.037, 0.0296},
                                            {2.22, 0.2, 0.037, 0.0296},
                                            {2.225, 0.2, 0.037, 0.0296},
                                            {2.23, 0.2, 0.037, 0.0296},
                                            {2.235, 0.2, 0.037, 0.0296},
                                            {2.24, 0.2, 0.037, 0.0296},
                                            {2.245, 0.2, 0.037, 0.0296},
                                            {2.25, 0.2, 0.037, 0.0296},
                                            {2.255, 0.2, 0.037, 0.0296},
                                            {2.26, 0.2, 0.037, 0.0296},
                                            {2.265, 0.2, 0.037, 0.0296},
                                            {2.27, 0.2, 0.037, 0.0296},
                                            {2.275, 0.2, 0.037, 0.0296},
                                            {2.28, 0.2, 0.037, 0.0296},
                                            {2.285, 0.2, 0.037, 0.0296},
                                            {2.29, 0.2, 0.037, 0.0296},
                                            {2.295, 0.2, 0.037, 0.0296},
                                            {2.3, 0.2, 0.037, 0.0296},
                                            {2.305, 0.2, 0.037, 0.0296},
                                            {2.31, 0.2, 0.037, 0.0296},
                                            {2.315, 0.2, 0.037, 0.0296},
                                            {2.32, 0.2, 0.037, 0.0296},
                                            {2.325, 0.2, 0.037, 0.0296},
                                            {2.33, 0.2, 0.037, 0.0296},
                                            {2.335, 0.2, 0.037, 0.0296},
                                            {2.34, 0.2, 0.037, 0.0296},
                                            {2.345, 0.2, 0.037, 0.0296},
                                            {2.35, 0.2, 0.037, 0.0296},
                                            {2.355, 0.2, 0.037, 0.0296},
                                            {2.36, 0.2, 0.037, 0.0296},
                                            {2.365, 0.2, 0.037, 0.0296},
                                            {2.37, 0.2, 0.037, 0.0296},
                                            {2.375, 0.2, 0.037, 0.0296},
                                            {2.38, 0.2, 0.037, 0.0296},
                                            {2.385, 0.2, 0.037, 0.0296},
                                            {2.39, 0.2, 0.037, 0.0296},
                                            {2.395, 0.2, 0.037, 0.0296},
                                            {2.4, 0.2, 0.037, 0.0296},
                                            {2.405, 0.2, 0.037, 0.0296},
                                            {2.41, 0.2, 0.037, 0.0296},
                                            {2.415, 0.2, 0.037, 0.0296},
                                            {2.42, 0.2, 0.037, 0.0296},
                                            {2.425, 0.2, 0.037, 0.0296},
                                            {2.43, 0.2, 0.037, 0.0296},
                                            {2.435, 0.2, 0.037, 0.0296},
                                            {2.44, 0.2, 0.037, 0.0296},
                                            {2.445, 0.2, 0.037, 0.0296},
                                            {2.45, 0.2, 0.037, 0.0296},
                                            {2.455, 0.2, 0.037, 0.0296},
                                            {2.46, 0.2, 0.037, 0.0296},
                                            {2.465, 0.2, 0.037, 0.0296},
                                            {2.47, 0.2, 0.037, 0.0296},
                                            {2.475, 0.2, 0.037, 0.0296},
                                            {2.48, 0.2, 0.037, 0.0296},
                                            {2.485, 0.2, 0.037, 0.0296},
                                            {2.49, 0.2, 0.037, 0.0296},
                                            {2.495, 0.2, 0.037, 0.0296},
                                            {2.5, 0.2, 0.037, 0.0296}});
    }

    static CSeries eqeFront()
    {
        CSeries eqe({{0.3, 0.510397771},
                     {0.305, 0.530202658},
                     {0.31, 0.546463796},
                     {0.315, 0.559586092},
                     {0.32, 0.571552208},
                     {0.325, 0.58511144},
                     {0.33, 0.594833945},
                     {0.335, 0.596920156},
                     {0.34, 0.598614669},
                     {0.345, 0.601842823},
                     {0.35, 0.606213441},
                     {0.355, 0.611253479},
                     {0.36, 0.616489895},
                     {0.365, 0.621449648},
                     {0.37, 0.625673259},
                     {0.375, 0.629499247},
                     {0.38, 0.633218923},
                     {0.385, 0.636761202},
                     {0.39, 0.640054997},
                     {0.395, 0.643029225},
                     {0.4, 0.64562212},
                     {0.405, 0.666189191},
                     {0.41, 0.688967337},
                     {0.415, 0.705239783},
                     {0.42, 0.718859625},
                     {0.425, 0.732646452},
                     {0.43, 0.743900286},
                     {0.435, 0.751686851},
                     {0.44, 0.758249729},
                     {0.445, 0.764742886},
                     {0.45, 0.770551915},
                     {0.455, 0.775303395},
                     {0.46, 0.779749255},
                     {0.465, 0.78413334},
                     {0.47, 0.788114938},
                     {0.475, 0.790169261},
                     {0.48, 0.791813242},
                     {0.485, 0.793447401},
                     {0.49, 0.794716477},
                     {0.495, 0.794056031},
                     {0.5, 0.793410686},
                     {0.505, 0.793245603},
                     {0.51, 0.791768062},
                     {0.515, 0.79058722},
                     {0.52, 0.78917107},
                     {0.525, 0.786947455},
                     {0.53, 0.78397838},
                     {0.535, 0.782835708},
                     {0.54, 0.781578696},
                     {0.545, 0.779511845},
                     {0.55, 0.777486113},
                     {0.555, 0.775002229},
                     {0.56, 0.772864935},
                     {0.565, 0.771358462},
                     {0.57, 0.768803212},
                     {0.575, 0.765388356},
                     {0.58, 0.762519987},
                     {0.585, 0.760859192},
                     {0.59, 0.759755165},
                     {0.595, 0.757673986},
                     {0.6, 0.755515976},
                     {0.605, 0.75393531},
                     {0.61, 0.752257769},
                     {0.615, 0.749918976},
                     {0.62, 0.747604183},
                     {0.625, 0.745721606},
                     {0.63, 0.743890164},
                     {0.635, 0.74186878},
                     {0.64, 0.739332693},
                     {0.645, 0.736771995},
                     {0.65, 0.73600967},
                     {0.655, 0.734235839},
                     {0.66, 0.731814958},
                     {0.665, 0.729521775},
                     {0.67, 0.728025867},
                     {0.675, 0.726410981},
                     {0.68, 0.724544249},
                     {0.685, 0.722473102},
                     {0.69, 0.720751082},
                     {0.695, 0.719159053},
                     {0.7, 0.717899975},
                     {0.705, 0.716816744},
                     {0.71, 0.714222677},
                     {0.715, 0.712505001},
                     {0.72, 0.711164971},
                     {0.725, 0.709739183},
                     {0.73, 0.707978246},
                     {0.735, 0.70618934},
                     {0.74, 0.704544849},
                     {0.745, 0.703039163},
                     {0.75, 0.701270154},
                     {0.755, 0.699446405},
                     {0.76, 0.697904472},
                     {0.765, 0.696741544},
                     {0.77, 0.695862913},
                     {0.775, 0.694546674},
                     {0.78, 0.692921063},
                     {0.785, 0.691246707},
                     {0.79, 0.689824558},
                     {0.795, 0.68873541},
                     {0.8, 0.687306081},
                     {0.805, 0.685349741},
                     {0.81, 0.683828542},
                     {0.815, 0.681434982},
                     {0.82, 0.678820294},
                     {0.825, 0.677849121},
                     {0.83, 0.678557243},
                     {0.835, 0.678248012},
                     {0.84, 0.676593674},
                     {0.845, 0.674696999},
                     {0.85, 0.673891601},
                     {0.855, 0.672475397},
                     {0.86, 0.671612943},
                     {0.865, 0.671953276},
                     {0.87, 0.671088101},
                     {0.875, 0.670271758},
                     {0.88, 0.670011701},
                     {0.885, 0.670053564},
                     {0.89, 0.668391643},
                     {0.895, 0.667504373},
                     {0.9, 0.667324764},
                     {0.905, 0.667324713},
                     {0.91, 0.666309634},
                     {0.915, 0.665278962},
                     {0.92, 0.664223849},
                     {0.925, 0.663010861},
                     {0.93, 0.661712744},
                     {0.935, 0.660355801},
                     {0.94, 0.658741275},
                     {0.945, 0.656429674},
                     {0.95, 0.654344453},
                     {0.955, 0.652454898},
                     {0.96, 0.650278795},
                     {0.965, 0.646663276},
                     {0.97, 0.642273044},
                     {0.975, 0.638535345},
                     {0.98, 0.633966322},
                     {0.985, 0.625710483},
                     {0.99, 0.618215375},
                     {0.995, 0.608515768},
                     {1, 0.597503032},
                     {1.005, 0.584045622},
                     {1.01, 0.569803856},
                     {1.015, 0.552877023},
                     {1.02, 0.533794093},
                     {1.025, 0.510364655},
                     {1.03, 0.486461532},
                     {1.035, 0.457639616},
                     {1.04, 0.42964699},
                     {1.045, 0.399516296},
                     {1.05, 0.37026196},
                     {1.055, 0.337839119},
                     {1.06, 0.304923105},
                     {1.065, 0.276540122},
                     {1.07, 0.249623243},
                     {1.075, 0.227439956},
                     {1.08, 0.208054824},
                     {1.085, 0.18725314},
                     {1.09, 0.171115428},
                     {1.095, 0.154515936},
                     {1.1, 0.142085253},
                     {1.105, 0.130088732},
                     {1.11, 0.11838672},
                     {1.115, 0.106684707},
                     {1.12, 0.094982695},
                     {1.125, 0.083280683},
                     {1.13, 0.07157867},
                     {1.135, 0.059876658},
                     {1.14, 0.048174646},
                     {1.145, 0.036472633},
                     {1.15, 0.024770621},
                     {1.155, 0.013068609},
                     {1.16, 0.001366596},
                     {1.165, 0},
                     {1.17, 0},
                     {1.175, 0},
                     {1.18, 0},
                     {1.185, 0},
                     {1.19, 0},
                     {1.195, 0},
                     {1.2, 0},
                     {1.205, 0},
                     {1.21, 0},
                     {1.215, 0},
                     {1.22, 0},
                     {1.225, 0},
                     {1.23, 0},
                     {1.235, 0},
                     {1.24, 0},
                     {1.245, 0},
                     {1.25, 0},
                     {1.255, 0},
                     {1.26, 0},
                     {1.265, 0},
                     {1.27, 0},
                     {1.275, 0},
                     {1.28, 0},
                     {1.285, 0},
                     {1.29, 0},
                     {1.295, 0},
                     {1.3, 0},
                     {1.305, 0},
                     {1.31, 0},
                     {1.315, 0},
                     {1.32, 0},
                     {1.325, 0},
                     {1.33, 0},
                     {1.335, 0},
                     {1.34, 0},
                     {1.345, 0},
                     {1.35, 0},
                     {1.355, 0},
                     {1.36, 0},
                     {1.365, 0},
                     {1.37, 0},
                     {1.375, 0},
                     {1.38, 0},
                     {1.385, 0},
                     {1.39, 0},
                     {1.395, 0},
                     {1.4, 0},
                     {1.405, 0},
                     {1.41, 0},
                     {1.415, 0},
                     {1.42, 0},
                     {1.425, 0},
                     {1.43, 0},
                     {1.435, 0},
                     {1.44, 0},
                     {1.445, 0},
                     {1.45, 0},
                     {1.455, 0},
                     {1.46, 0},
                     {1.465, 0},
                     {1.47, 0},
                     {1.475, 0},
                     {1.48, 0},
                     {1.485, 0},
                     {1.49, 0},
                     {1.495, 0},
                     {1.5, 0},
                     {1.505, 0},
                     {1.51, 0},
                     {1.515, 0},
                     {1.52, 0},
                     {1.525, 0},
                     {1.53, 0},
                     {1.535, 0},
                     {1.54, 0},
                     {1.545, 0},
                     {1.55, 0},
                     {1.555, 0},
                     {1.56, 0},
                     {1.565, 0},
                     {1.57, 0},
                     {1.575, 0},
                     {1.58, 0},
                     {1.585, 0},
                     {1.59, 0},
                     {1.595, 0},
                     {1.6, 0},
                     {1.605, 0},
                     {1.61, 0},
                     {1.615, 0},
                     {1.62, 0},
                     {1.625, 0},
                     {1.63, 0},
                     {1.635, 0},
                     {1.64, 0},
                     {1.645, 0},
                     {1.65, 0},
                     {1.655, 0},
                     {1.66, 0},
                     {1.665, 0},
                     {1.67, 0},
                     {1.675, 0},
                     {1.68, 0},
                     {1.685, 0},
                     {1.69, 0},
                     {1.695, 0},
                     {1.7, 0},
                     {1.705, 0},
                     {1.71, 0},
                     {1.715, 0},
                     {1.72, 0},
                     {1.725, 0},
                     {1.73, 0},
                     {1.735, 0},
                     {1.74, 0},
                     {1.745, 0},
                     {1.75, 0},
                     {1.755, 0},
                     {1.76, 0},
                     {1.765, 0},
                     {1.77, 0},
                     {1.775, 0},
                     {1.78, 0},
                     {1.785, 0},
                     {1.79, 0},
                     {1.795, 0},
                     {1.8, 0},
                     {1.805, 0},
                     {1.81, 0},
                     {1.815, 0},
                     {1.82, 0},
                     {1.825, 0},
                     {1.83, 0},
                     {1.835, 0},
                     {1.84, 0},
                     {1.845, 0},
                     {1.85, 0},
                     {1.855, 0},
                     {1.86, 0},
                     {1.865, 0},
                     {1.87, 0},
                     {1.875, 0},
                     {1.88, 0},
                     {1.885, 0},
                     {1.89, 0},
                     {1.895, 0},
                     {1.9, 0},
                     {1.905, 0},
                     {1.91, 0},
                     {1.915, 0},
                     {1.92, 0},
                     {1.925, 0},
                     {1.93, 0},
                     {1.935, 0},
                     {1.94, 0},
                     {1.945, 0},
                     {1.95, 0},
                     {1.955, 0},
                     {1.96, 0},
                     {1.965, 0},
                     {1.97, 0},
                     {1.975, 0},
                     {1.98, 0},
                     {1.985, 0},
                     {1.99, 0},
                     {1.995, 0},
                     {2, 0},
                     {2.005, 0},
                     {2.01, 0},
                     {2.015, 0},
                     {2.02, 0},
                     {2.025, 0},
                     {2.03, 0},
                     {2.035, 0},
                     {2.04, 0},
                     {2.045, 0},
                     {2.05, 0},
                     {2.055, 0},
                     {2.06, 0},
                     {2.065, 0},
                     {2.07, 0},
                     {2.075, 0},
                     {2.08, 0},
                     {2.085, 0},
                     {2.09, 0},
                     {2.095, 0},
                     {2.1, 0},
                     {2.105, 0},
                     {2.11, 0},
                     {2.115, 0},
                     {2.12, 0},
                     {2.125, 0},
                     {2.13, 0},
                     {2.135, 0},
                     {2.14, 0},
                     {2.145, 0},
                     {2.15, 0},
                     {2.155, 0},
                     {2.16, 0},
                     {2.165, 0},
                     {2.17, 0},
                     {2.175, 0},
                     {2.18, 0},
                     {2.185, 0},
                     {2.19, 0},
                     {2.195, 0},
                     {2.2, 0},
                     {2.205, 0},
                     {2.21, 0},
                     {2.215, 0},
                     {2.22, 0},
                     {2.225, 0},
                     {2.23, 0},
                     {2.235, 0},
                     {2.24, 0},
                     {2.245, 0},
                     {2.25, 0},
                     {2.255, 0},
                     {2.26, 0},
                     {2.265, 0},
                     {2.27, 0},
                     {2.275, 0},
                     {2.28, 0},
                     {2.285, 0},
                     {2.29, 0},
                     {2.295, 0},
                     {2.3, 0},
                     {2.305, 0},
                     {2.31, 0},
                     {2.315, 0},
                     {2.32, 0},
                     {2.325, 0},
                     {2.33, 0},
                     {2.335, 0},
                     {2.34, 0},
                     {2.345, 0},
                     {2.35, 0},
                     {2.355, 0},
                     {2.36, 0},
                     {2.365, 0},
                     {2.37, 0},
                     {2.375, 0},
                     {2.38, 0},
                     {2.385, 0},
                     {2.39, 0},
                     {2.395, 0},
                     {2.4, 0},
                     {2.405, 0},
                     {2.41, 0},
                     {2.415, 0},
                     {2.42, 0},
                     {2.425, 0},
                     {2.43, 0},
                     {2.435, 0},
                     {2.44, 0},
                     {2.445, 0},
                     {2.45, 0},
                     {2.455, 0},
                     {2.46, 0},
                     {2.465, 0},
                     {2.47, 0},
                     {2.475, 0},
                     {2.48, 0},
                     {2.485, 0},
                     {2.49, 0},
                     {2.495, 0},
                     {2.5, 0}});

        return eqe;
    }

    static CSeries eqeBack()
    {
        CSeries eqe({{0.3, 0.255198885},
                     {0.305, 0.265101329},
                     {0.31, 0.273231898},
                     {0.315, 0.279793046},
                     {0.32, 0.285776104},
                     {0.325, 0.29255572},
                     {0.33, 0.297416973},
                     {0.335, 0.298460078},
                     {0.34, 0.299307335},
                     {0.345, 0.300921412},
                     {0.35, 0.30310672},
                     {0.355, 0.305626739},
                     {0.36, 0.308244948},
                     {0.365, 0.310724824},
                     {0.37, 0.312836629},
                     {0.375, 0.314749624},
                     {0.38, 0.316609462},
                     {0.385, 0.318380601},
                     {0.39, 0.320027499},
                     {0.395, 0.321514613},
                     {0.4, 0.32281106},
                     {0.405, 0.333094596},
                     {0.41, 0.344483669},
                     {0.415, 0.352619892},
                     {0.42, 0.359429813},
                     {0.425, 0.366323226},
                     {0.43, 0.371950143},
                     {0.435, 0.375843425},
                     {0.44, 0.379124864},
                     {0.445, 0.382371443},
                     {0.45, 0.385275958},
                     {0.455, 0.387651698},
                     {0.46, 0.389874628},
                     {0.465, 0.39206667},
                     {0.47, 0.394057469},
                     {0.475, 0.39508463},
                     {0.48, 0.395906621},
                     {0.485, 0.396723701},
                     {0.49, 0.397358238},
                     {0.495, 0.397028016},
                     {0.5, 0.396705343},
                     {0.505, 0.396622801},
                     {0.51, 0.395884031},
                     {0.515, 0.39529361},
                     {0.52, 0.394585535},
                     {0.525, 0.393473728},
                     {0.53, 0.39198919},
                     {0.535, 0.391417854},
                     {0.54, 0.390789348},
                     {0.545, 0.389755922},
                     {0.55, 0.388743057},
                     {0.555, 0.387501114},
                     {0.56, 0.386432468},
                     {0.565, 0.385679231},
                     {0.57, 0.384401606},
                     {0.575, 0.382694178},
                     {0.58, 0.381259994},
                     {0.585, 0.380429596},
                     {0.59, 0.379877582},
                     {0.595, 0.378836993},
                     {0.6, 0.377757988},
                     {0.605, 0.376967655},
                     {0.61, 0.376128884},
                     {0.615, 0.374959488},
                     {0.62, 0.373802091},
                     {0.625, 0.372860803},
                     {0.63, 0.371945082},
                     {0.635, 0.37093439},
                     {0.64, 0.369666346},
                     {0.645, 0.368385998},
                     {0.65, 0.368004835},
                     {0.655, 0.367117919},
                     {0.66, 0.365907479},
                     {0.665, 0.364760887},
                     {0.67, 0.364012933},
                     {0.675, 0.363205491},
                     {0.68, 0.362272125},
                     {0.685, 0.361236551},
                     {0.69, 0.360375541},
                     {0.695, 0.359579526},
                     {0.7, 0.358949988},
                     {0.705, 0.358408372},
                     {0.71, 0.357111339},
                     {0.715, 0.356252501},
                     {0.72, 0.355582486},
                     {0.725, 0.354869591},
                     {0.73, 0.353989123},
                     {0.735, 0.35309467},
                     {0.74, 0.352272424},
                     {0.745, 0.351519582},
                     {0.75, 0.350635077},
                     {0.755, 0.349723203},
                     {0.76, 0.348952236},
                     {0.765, 0.348370772},
                     {0.77, 0.347931457},
                     {0.775, 0.347273337},
                     {0.78, 0.346460531},
                     {0.785, 0.345623353},
                     {0.79, 0.344912279},
                     {0.795, 0.344367705},
                     {0.8, 0.343653041},
                     {0.805, 0.34267487},
                     {0.81, 0.341914271},
                     {0.815, 0.340717491},
                     {0.82, 0.339410147},
                     {0.825, 0.33892456},
                     {0.83, 0.339278622},
                     {0.835, 0.339124006},
                     {0.84, 0.338296837},
                     {0.845, 0.3373485},
                     {0.85, 0.336945801},
                     {0.855, 0.336237698},
                     {0.86, 0.335806471},
                     {0.865, 0.335976638},
                     {0.87, 0.335544051},
                     {0.875, 0.335135879},
                     {0.88, 0.33500585},
                     {0.885, 0.335026782},
                     {0.89, 0.334195822},
                     {0.895, 0.333752187},
                     {0.9, 0.333662382},
                     {0.905, 0.333662356},
                     {0.91, 0.333154817},
                     {0.915, 0.332639481},
                     {0.92, 0.332111924},
                     {0.925, 0.331505431},
                     {0.93, 0.330856372},
                     {0.935, 0.3301779},
                     {0.94, 0.329370638},
                     {0.945, 0.328214837},
                     {0.95, 0.327172227},
                     {0.955, 0.326227449},
                     {0.96, 0.325139398},
                     {0.965, 0.323331638},
                     {0.97, 0.321136522},
                     {0.975, 0.319267672},
                     {0.98, 0.316983161},
                     {0.985, 0.312855241},
                     {0.99, 0.309107688},
                     {0.995, 0.304257884},
                     {1, 0.298751516},
                     {1.005, 0.292022811},
                     {1.01, 0.284901928},
                     {1.015, 0.276438511},
                     {1.02, 0.266897046},
                     {1.025, 0.255182328},
                     {1.03, 0.243230766},
                     {1.035, 0.228819808},
                     {1.04, 0.214823495},
                     {1.045, 0.199758148},
                     {1.05, 0.18513098},
                     {1.055, 0.16891956},
                     {1.06, 0.152461552},
                     {1.065, 0.138270061},
                     {1.07, 0.124811622},
                     {1.075, 0.113719978},
                     {1.08, 0.104027412},
                     {1.085, 0.09362657},
                     {1.09, 0.085557714},
                     {1.095, 0.077257968},
                     {1.1, 0.071042627},
                     {1.105, 0.065044366},
                     {1.11, 0.05919336},
                     {1.115, 0.053342354},
                     {1.12, 0.047491348},
                     {1.125, 0.041640342},
                     {1.13, 0.035789335},
                     {1.135, 0.029938329},
                     {1.14, 0.024087323},
                     {1.145, 0.018236317},
                     {1.15, 0.012385311},
                     {1.155, 0.006534305},
                     {1.16, 0.000683298},
                     {1.165, 0},
                     {1.17, 0},
                     {1.175, 0},
                     {1.18, 0},
                     {1.185, 0},
                     {1.19, 0},
                     {1.195, 0},
                     {1.2, 0},
                     {1.205, 0},
                     {1.21, 0},
                     {1.215, 0},
                     {1.22, 0},
                     {1.225, 0},
                     {1.23, 0},
                     {1.235, 0},
                     {1.24, 0},
                     {1.245, 0},
                     {1.25, 0},
                     {1.255, 0},
                     {1.26, 0},
                     {1.265, 0},
                     {1.27, 0},
                     {1.275, 0},
                     {1.28, 0},
                     {1.285, 0},
                     {1.29, 0},
                     {1.295, 0},
                     {1.3, 0},
                     {1.305, 0},
                     {1.31, 0},
                     {1.315, 0},
                     {1.32, 0},
                     {1.325, 0},
                     {1.33, 0},
                     {1.335, 0},
                     {1.34, 0},
                     {1.345, 0},
                     {1.35, 0},
                     {1.355, 0},
                     {1.36, 0},
                     {1.365, 0},
                     {1.37, 0},
                     {1.375, 0},
                     {1.38, 0},
                     {1.385, 0},
                     {1.39, 0},
                     {1.395, 0},
                     {1.4, 0},
                     {1.405, 0},
                     {1.41, 0},
                     {1.415, 0},
                     {1.42, 0},
                     {1.425, 0},
                     {1.43, 0},
                     {1.435, 0},
                     {1.44, 0},
                     {1.445, 0},
                     {1.45, 0},
                     {1.455, 0},
                     {1.46, 0},
                     {1.465, 0},
                     {1.47, 0},
                     {1.475, 0},
                     {1.48, 0},
                     {1.485, 0},
                     {1.49, 0},
                     {1.495, 0},
                     {1.5, 0},
                     {1.505, 0},
                     {1.51, 0},
                     {1.515, 0},
                     {1.52, 0},
                     {1.525, 0},
                     {1.53, 0},
                     {1.535, 0},
                     {1.54, 0},
                     {1.545, 0},
                     {1.55, 0},
                     {1.555, 0},
                     {1.56, 0},
                     {1.565, 0},
                     {1.57, 0},
                     {1.575, 0},
                     {1.58, 0},
                     {1.585, 0},
                     {1.59, 0},
                     {1.595, 0},
                     {1.6, 0},
                     {1.605, 0},
                     {1.61, 0},
                     {1.615, 0},
                     {1.62, 0},
                     {1.625, 0},
                     {1.63, 0},
                     {1.635, 0},
                     {1.64, 0},
                     {1.645, 0},
                     {1.65, 0},
                     {1.655, 0},
                     {1.66, 0},
                     {1.665, 0},
                     {1.67, 0},
                     {1.675, 0},
                     {1.68, 0},
                     {1.685, 0},
                     {1.69, 0},
                     {1.695, 0},
                     {1.7, 0},
                     {1.705, 0},
                     {1.71, 0},
                     {1.715, 0},
                     {1.72, 0},
                     {1.725, 0},
                     {1.73, 0},
                     {1.735, 0},
                     {1.74, 0},
                     {1.745, 0},
                     {1.75, 0},
                     {1.755, 0},
                     {1.76, 0},
                     {1.765, 0},
                     {1.77, 0},
                     {1.775, 0},
                     {1.78, 0},
                     {1.785, 0},
                     {1.79, 0},
                     {1.795, 0},
                     {1.8, 0},
                     {1.805, 0},
                     {1.81, 0},
                     {1.815, 0},
                     {1.82, 0},
                     {1.825, 0},
                     {1.83, 0},
                     {1.835, 0},
                     {1.84, 0},
                     {1.845, 0},
                     {1.85, 0},
                     {1.855, 0},
                     {1.86, 0},
                     {1.865, 0},
                     {1.87, 0},
                     {1.875, 0},
                     {1.88, 0},
                     {1.885, 0},
                     {1.89, 0},
                     {1.895, 0},
                     {1.9, 0},
                     {1.905, 0},
                     {1.91, 0},
                     {1.915, 0},
                     {1.92, 0},
                     {1.925, 0},
                     {1.93, 0},
                     {1.935, 0},
                     {1.94, 0},
                     {1.945, 0},
                     {1.95, 0},
                     {1.955, 0},
                     {1.96, 0},
                     {1.965, 0},
                     {1.97, 0},
                     {1.975, 0},
                     {1.98, 0},
                     {1.985, 0},
                     {1.99, 0},
                     {1.995, 0},
                     {2, 0},
                     {2.005, 0},
                     {2.01, 0},
                     {2.015, 0},
                     {2.02, 0},
                     {2.025, 0},
                     {2.03, 0},
                     {2.035, 0},
                     {2.04, 0},
                     {2.045, 0},
                     {2.05, 0},
                     {2.055, 0},
                     {2.06, 0},
                     {2.065, 0},
                     {2.07, 0},
                     {2.075, 0},
                     {2.08, 0},
                     {2.085, 0},
                     {2.09, 0},
                     {2.095, 0},
                     {2.1, 0},
                     {2.105, 0},
                     {2.11, 0},
                     {2.115, 0},
                     {2.12, 0},
                     {2.125, 0},
                     {2.13, 0},
                     {2.135, 0},
                     {2.14, 0},
                     {2.145, 0},
                     {2.15, 0},
                     {2.155, 0},
                     {2.16, 0},
                     {2.165, 0},
                     {2.17, 0},
                     {2.175, 0},
                     {2.18, 0},
                     {2.185, 0},
                     {2.19, 0},
                     {2.195, 0},
                     {2.2, 0},
                     {2.205, 0},
                     {2.21, 0},
                     {2.215, 0},
                     {2.22, 0},
                     {2.225, 0},
                     {2.23, 0},
                     {2.235, 0},
                     {2.24, 0},
                     {2.245, 0},
                     {2.25, 0},
                     {2.255, 0},
                     {2.26, 0},
                     {2.265, 0},
                     {2.27, 0},
                     {2.275, 0},
                     {2.28, 0},
                     {2.285, 0},
                     {2.29, 0},
                     {2.295, 0},
                     {2.3, 0},
                     {2.305, 0},
                     {2.31, 0},
                     {2.315, 0},
                     {2.32, 0},
                     {2.325, 0},
                     {2.33, 0},
                     {2.335, 0},
                     {2.34, 0},
                     {2.345, 0},
                     {2.35, 0},
                     {2.355, 0},
                     {2.36, 0},
                     {2.365, 0},
                     {2.37, 0},
                     {2.375, 0},
                     {2.38, 0},
                     {2.385, 0},
                     {2.39, 0},
                     {2.395, 0},
                     {2.4, 0},
                     {2.405, 0},
                     {2.41, 0},
                     {2.415, 0},
                     {2.42, 0},
                     {2.425, 0},
                     {2.43, 0},
                     {2.435, 0},
                     {2.44, 0},
                     {2.445, 0},
                     {2.45, 0},
                     {2.455, 0},
                     {2.46, 0},
                     {2.465, 0},
                     {2.47, 0},
                     {2.475, 0},
                     {2.48, 0},
                     {2.485, 0},
                     {2.49, 0},
                     {2.495, 0},
                     {2.5, 0}});

        return eqe;
    }

    static SingleLayerOptics::PVPowerPropertiesTable table()
    {
        return {{{0.1, 0.025138331, 0},
                 {0.2, 0.050272444, 0.240669626},
                 {0.3, 0.075399049, 0.239605589},
                 {0.4, 0.100512561, 0.240709976},
                 {0.5, 0.125603883, 0.249637989},
                 {0.6, 0.150659177, 0.240822687},
                 {0.7, 0.175629168, 0.250278056},
                 {0.8, 0.200454106, 0.247994974},
                 {0.9, 0.225033563, 0.250252448},
                 {1, 0.249215435, 0.251524068},
                 {1.1, 0.272822805, 0.251231936},
                 {1.2, 0.295322134, 0.255077342},
                 {1.3, 0.316082522, 0.256495777},
                 {1.4, 0.335331354, 0.261679801},
                 {1.5, 0.352280871, 0.266547198},
                 {1.6, 0.366913679, 0.272398675},
                 {1.7, 0.379609083, 0.28034239},
                 {1.8, 0.391527087, 0.286506188},
                 {1.9, 0.399939797, 0.296499943},
                 {2, 0.408352507, 0.30525837},
                 {2.1, 0.416765217, 0.312368938},
                 {2.2, 0.42307435, 0.3227323},
                 {2.3, 0.428069324, 0.332521788},
                 {2.4, 0.433064298, 0.340968871},
                 {2.5, 0.438059273, 0.35042076},
                 {2.6, 0.443054247, 0.359187357},
                 {2.7, 0.448049221, 0.366826974},
                 {2.8, 0.45166894, 0.374612763},
                 {2.9, 0.454407369, 0.383508171},
                 {3, 0.457145798, 0.392566168},
                 {3.1, 0.459884227, 0.400788053},
                 {3.2, 0.462622656, 0.408256542},
                 {3.3, 0.465361085, 0.415044226},
                 {3.4, 0.468099514, 0.421215061},
                 {3.5, 0.470837943, 0.426962145},
                 {3.6, 0.473576372, 0.433817699},
                 {3.7, 0.476314801, 0.440093299},
                 {3.8, 0.479053231, 0.445838227},
                 {3.9, 0.480934939, 0.451900202},
                 {4, 0.482363928, 0.457955535},
                 {4.1, 0.483792918, 0.463615476},
                 {4.2, 0.485221908, 0.468909128},
                 {4.3, 0.486650897, 0.473862881},
                 {4.4, 0.488079887, 0.478500712},
                 {4.5, 0.489508877, 0.482844461},
                 {4.6, 0.490937866, 0.486914058},
                 {4.7, 0.492366856, 0.491796993},
                 {4.8, 0.493795846, 0.496611836},
                 {4.9, 0.495224835, 0.501145012},
                 {5, 0.496653825, 0.505414142},
                 {5.1, 0.498082815, 0.509435457},
                 {5.2, 0.499511804, 0.513223929},
                 {5.3, 0.500940794, 0.516793395},
                 {5.4, 0.502369783, 0.520156658},
                 {5.5, 0.503798773, 0.523325586},
                 {5.6, 0.505227763, 0.526311188},
                 {5.7, 0.506656752, 0.529123697},
                 {5.8, 0.508085742, 0.531772632},
                 {5.9, 0.509514732, 0.534266861},
                 {6, 0.510479066, 0.5371031},
                 {6.1, 0.511204472, 0.540055095},
                 {6.2, 0.511929877, 0.542879082},
                 {6.3, 0.512655283, 0.545581294},
                 {6.4, 0.513380688, 0.548167573},
                 {6.5, 0.514106094, 0.550643402},
                 {6.6, 0.5148315, 0.553013928},
                 {6.7, 0.515556905, 0.555283995},
                 {6.8, 0.516282311, 0.557677821},
                 {6.9, 0.517007716, 0.560597839},
                 {7, 0.517733122, 0.563404038},
                 {7.1, 0.518458527, 0.566101352},
                 {7.2, 0.519183933, 0.568694441},
                 {7.3, 0.519909338, 0.57118771},
                 {7.4, 0.520634744, 0.573585325},
                 {7.5, 0.521360149, 0.575891227},
                 {7.6, 0.522085555, 0.578109151},
                 {7.7, 0.522810961, 0.580242637},
                 {7.8, 0.523536366, 0.582295043},
                 {7.9, 0.524261772, 0.584269556},
                 {8, 0.524987177, 0.586169202},
                 {8.1, 0.525712583, 0.58799686},
                 {8.2, 0.526437988, 0.589755266},
                 {8.3, 0.527163394, 0.591447022},
                 {8.4, 0.527888799, 0.593074608},
                 {8.5, 0.528614205, 0.594640387},
                 {8.6, 0.52933961, 0.596146609},
                 {8.7, 0.530065016, 0.597595423},
                 {8.8, 0.530790421, 0.598988878},
                 {8.9, 0.531515827, 0.600328931},
                 {9, 0.532241233, 0.60161745},
                 {9.1, 0.532966638, 0.602856224},
                 {9.2, 0.533692044, 0.60404696},
                 {9.3, 0.534417449, 0.605191293},
                 {9.4, 0.535142855, 0.606290788},
                 {9.5, 0.53586826, 0.607346942},
                 {9.6, 0.536593666, 0.608361192},
                 {9.7, 0.537319071, 0.609334914},
                 {9.8, 0.538044477, 0.610269425},
                 {9.9, 0.538769882, 0.611165993},
                 {10, 0.539495288, 0.612025831},
                 {10.1, 0.540110417, 0.612975233},
                 {10.2, 0.540473352, 0.61417668},
                 {10.3, 0.540836287, 0.615345215},
                 {10.4, 0.541199222, 0.616481804},
                 {10.5, 0.541562157, 0.617587381},
                 {10.6, 0.541925092, 0.618662841},
                 {10.7, 0.542288027, 0.619709047},
                 {10.8, 0.542650962, 0.62072683},
                 {10.9, 0.543013896, 0.62171699},
                 {11, 0.543376831, 0.622680298},
                 {11.1, 0.543739766, 0.623617497},
                 {11.2, 0.544102701, 0.624787726},
                 {11.3, 0.544465636, 0.626159985},
                 {11.4, 0.544828571, 0.627499056},
                 {11.5, 0.545191506, 0.628805822},
                 {11.6, 0.545554441, 0.630081137},
                 {11.7, 0.545917376, 0.631325824},
                 {11.8, 0.54628031, 0.632540679},
                 {11.9, 0.546643245, 0.633726473},
                 {12, 0.54700618, 0.634883948},
                 {12.1, 0.547369115, 0.636013824},
                 {12.2, 0.54773205, 0.637116795},
                 {12.3, 0.548094985, 0.638193536},
                 {12.4, 0.54845792, 0.639244696},
                 {12.5, 0.548820855, 0.640270905},
                 {12.6, 0.54918379, 0.641272775},
                 {12.7, 0.549546724, 0.642250895},
                 {12.8, 0.549909659, 0.643205838},
                 {12.9, 0.550272594, 0.644138158},
                 {13, 0.550635529, 0.645048393},
                 {13.1, 0.550998464, 0.645937063},
                 {13.2, 0.551361399, 0.646804675},
                 {13.3, 0.551724334, 0.647651717},
                 {13.4, 0.552087269, 0.648478665},
                 {13.5, 0.552450204, 0.64928598},
                 {13.6, 0.552813138, 0.65007411},
                 {13.7, 0.553176073, 0.650843488},
                 {13.8, 0.553539008, 0.651594538},
                 {13.9, 0.553901943, 0.652327667},
                 {14, 0.554264878, 0.653043275},
                 {14.1, 0.554627813, 0.653741748},
                 {14.2, 0.554990748, 0.654423461},
                 {14.3, 0.555353683, 0.65508878},
                 {14.4, 0.555716617, 0.655738059},
                 {14.5, 0.556079552, 0.656371643},
                 {14.6, 0.556442487, 0.656989869},
                 {14.7, 0.556805422, 0.657593061},
                 {14.8, 0.557168357, 0.658181539},
                 {14.9, 0.557531292, 0.658755611},
                 {15, 0.557894227, 0.659315578},
                 {15.1, 0.558257162, 0.659861732},
                 {15.2, 0.558620097, 0.660394359},
                 {15.3, 0.558983031, 0.660913735},
                 {15.4, 0.559345966, 0.661420132},
                 {15.5, 0.559708901, 0.661913813},
                 {15.6, 0.560071836, 0.662395033},
                 {15.7, 0.560434771, 0.662864044},
                 {15.8, 0.560797706, 0.663321088},
                 {15.9, 0.561160641, 0.663766402},
                 {16, 0.561523576, 0.66420022},
                 {16.1, 0.561886511, 0.664622765},
                 {16.2, 0.562249445, 0.665034259},
                 {16.3, 0.56261238, 0.665434915},
                 {16.4, 0.562975315, 0.665824943},
                 {16.5, 0.56333825, 0.666204548},
                 {16.6, 0.563701185, 0.666573928},
                 {16.7, 0.56406412, 0.666933279},
                 {16.8, 0.564427055, 0.667282789},
                 {16.9, 0.56478999, 0.667622645},
                 {17, 0.565152924, 0.667953027},
                 {17.1, 0.565515859, 0.668274113},
                 {17.2, 0.565878794, 0.668586074},
                 {17.3, 0.566241729, 0.668889079},
                 {17.4, 0.566604664, 0.669183292},
                 {17.5, 0.566967599, 0.669468876},
                 {17.6, 0.567330534, 0.669745986},
                 {17.7, 0.567693469, 0.670014776},
                 {17.8, 0.568056404, 0.670275397},
                 {17.9, 0.568419338, 0.670527995},
                 {18, 0.568782273, 0.670772713},
                 {18.1, 0.569145208, 0.671009693},
                 {18.2, 0.569508143, 0.67123907},
                 {18.3, 0.569871078, 0.671460979},
                 {18.4, 0.570116218, 0.671814331},
                 {18.5, 0.570296462, 0.672236928},
                 {18.6, 0.570476706, 0.672652432},
                 {18.7, 0.57065695, 0.673060961},
                 {18.8, 0.570837194, 0.673462628},
                 {18.9, 0.571017438, 0.673857543},
                 {19, 0.571197683, 0.674245817},
                 {19.1, 0.571377927, 0.674627556},
                 {19.2, 0.571558171, 0.675002863},
                 {19.3, 0.571738415, 0.675371842},
                 {19.4, 0.571918659, 0.675734593},
                 {19.5, 0.572098903, 0.676091214},
                 {19.6, 0.572279147, 0.6764418},
                 {19.7, 0.572459392, 0.676786446},
                 {19.8, 0.572639636, 0.677125244},
                 {19.9, 0.57281988, 0.677458285},
                 {20, 0.573000124, 0.677785657},
                 {20.1, 0.573180368, 0.678107447},
                 {20.2, 0.573360612, 0.67842374},
                 {20.3, 0.573540857, 0.678818741},
                 {20.4, 0.573721101, 0.679380174},
                 {20.5, 0.573901345, 0.679933699},
                 {20.6, 0.574081589, 0.680479434},
                 {20.7, 0.574261833, 0.681017493},
                 {20.8, 0.574442077, 0.681547989},
                 {20.9, 0.574622321, 0.682071033},
                 {21, 0.574802566, 0.682586734},
                 {21.1, 0.57498281, 0.683095198},
                 {21.2, 0.575163054, 0.68359653},
                 {21.3, 0.575343298, 0.684090833},
                 {21.4, 0.575523542, 0.684578208},
                 {21.5, 0.575703786, 0.685058752},
                 {21.6, 0.575884031, 0.685532563},
                 {21.7, 0.576064275, 0.685999737},
                 {21.8, 0.576244519, 0.686460367},
                 {21.9, 0.576424763, 0.686914545},
                 {22, 0.576605007, 0.68736236},
                 {22.1, 0.576785251, 0.687803901},
                 {22.2, 0.576965495, 0.688239255},
                 {22.3, 0.57714574, 0.688668508},
                 {22.4, 0.577325984, 0.689091742},
                 {22.5, 0.577506228, 0.689509041},
                 {22.6, 0.577686472, 0.689920485},
                 {22.7, 0.577866716, 0.690326154},
                 {22.8, 0.57804696, 0.690726125},
                 {22.9, 0.578227204, 0.691120475},
                 {23, 0.578407449, 0.69150928},
                 {23.1, 0.578587693, 0.691892613},
                 {23.2, 0.578767937, 0.692270548},
                 {23.3, 0.578948181, 0.692643155},
                 {23.4, 0.579128425, 0.693010504},
                 {23.5, 0.579308669, 0.693372666},
                 {23.6, 0.579488914, 0.693729708},
                 {23.7, 0.579669158, 0.694081696},
                 {23.8, 0.579849402, 0.694428696},
                 {23.9, 0.580029646, 0.694770773},
                 {24, 0.58020989, 0.695107989},
                 {24.1, 0.580390134, 0.695440408},
                 {24.2, 0.580570378, 0.695768091},
                 {24.3, 0.580750623, 0.696091098},
                 {24.4, 0.580930867, 0.696409488},
                 {24.5, 0.581111111, 0.696723319},
                 {24.6, 0.581291355, 0.69703265},
                 {24.7, 0.581471599, 0.697337536},
                 {24.8, 0.581651843, 0.697638034},
                 {24.9, 0.581832087, 0.697934197},
                 {25, 0.582012332, 0.69822608},
                 {25.1, 0.582192576, 0.698513735},
                 {25.2, 0.58237282, 0.698797215},
                 {25.3, 0.582553064, 0.699076571},
                 {25.4, 0.582733308, 0.699351853},
                 {25.5, 0.582913552, 0.699623111},
                 {25.6, 0.583093797, 0.699890394},
                 {25.7, 0.583274041, 0.70015375},
                 {25.8, 0.583454285, 0.700413226},
                 {25.9, 0.583634529, 0.700668869},
                 {25.99999999, 0.583814773, 0.700920725},
                 {26.09999999, 0.583995017, 0.701168839},
                 {26.19999999, 0.584175261, 0.701413255},
                 {26.29999999, 0.584355506, 0.701654018},
                 {26.39999999, 0.58453575, 0.701891171},
                 {26.49999999, 0.584715994, 0.702124756},
                 {26.59999999, 0.584896238, 0.702354814},
                 {26.69999999, 0.585076482, 0.702581388},
                 {26.79999999, 0.585256726, 0.702804518},
                 {26.89999999, 0.58543697, 0.703024244},
                 {26.99999999, 0.585617215, 0.703240605},
                 {27.09999999, 0.585797459, 0.70345364},
                 {27.19999999, 0.585977703, 0.703663388},
                 {27.29999999, 0.586157947, 0.703869886},
                 {27.39999999, 0.586338191, 0.704073171},
                 {27.49999999, 0.586518435, 0.70427328},
                 {27.59999999, 0.58669868, 0.704470249},
                 {27.69999999, 0.586878924, 0.704664114},
                 {27.79999999, 0.587059168, 0.704854909},
                 {27.89999999, 0.587239412, 0.70504267},
                 {27.99999999, 0.587419656, 0.70522743},
                 {28.09999999, 0.5875999, 0.705409222},
                 {28.19999999, 0.587780144, 0.70558808},
                 {28.29999999, 0.587960389, 0.705764037},
                 {28.39999999, 0.588140633, 0.705937124},
                 {28.49999999, 0.588320877, 0.706107374},
                 {28.59999999, 0.588501121, 0.706274817},
                 {28.69999999, 0.588681365, 0.706439485},
                 {28.79999999, 0.588861609, 0.706601407},
                 {28.89999999, 0.589041853, 0.706760614},
                 {28.99999999, 0.589222098, 0.706917135},
                 {29.09999999, 0.589402342, 0.707071},
                 {29.19999999, 0.589582586, 0.707222236},
                 {29.29999999, 0.58976283, 0.707370874},
                 {29.39999999, 0.589943074, 0.707516939},
                 {29.49999999, 0.590123318, 0.707660461},
                 {29.59999999, 0.590303562, 0.707801466},
                 {29.69999999, 0.590483807, 0.707939981},
                 {29.79999999, 0.590664051, 0.708076032},
                 {29.89999999, 0.590844295, 0.708209647},
                 {29.99999999, 0.591024539, 0.708340849},
                 {30.09999999, 0.591204783, 0.708469665},
                 {30.19999999, 0.591385027, 0.708596121},
                 {30.29999999, 0.591565271, 0.70872024},
                 {30.39999999, 0.591745516, 0.708842047},
                 {30.49999999, 0.59192576, 0.708961566},
                 {30.59999999, 0.592106004, 0.709078821},
                 {30.69999999, 0.592286248, 0.709193836},
                 {30.79999999, 0.592466492, 0.709306633},
                 {30.89999999, 0.592646736, 0.709417236},
                 {30.99999999, 0.592826981, 0.709525667},
                 {31.09999999, 0.593007225, 0.709631948},
                 {31.19999999, 0.593187469, 0.709736101},
                 {31.29999999, 0.593367713, 0.709838149},
                 {31.39999999, 0.593547957, 0.709938111},
                 {31.49999999, 0.593728201, 0.710036011},
                 {31.59999999, 0.593908445, 0.710131868},
                 {31.69999999, 0.59408869, 0.710225703},
                 {31.79999999, 0.594268934, 0.710317537},
                 {31.89999999, 0.594449178, 0.710407389},
                 {31.99999999, 0.594629422, 0.710495279},
                 {32.09999999, 0.594809666, 0.710581228},
                 {32.19999999, 0.59498991, 0.710665254},
                 {32.29999999, 0.595170154, 0.710747376},
                 {32.39999999, 0.595350399, 0.710827614},
                 {32.49999999, 0.595530643, 0.710905986},
                 {32.59999999, 0.595710887, 0.71098251},
                 {32.69999999, 0.595891131, 0.711057205},
                 {32.79999999, 0.596071375, 0.711130089},
                 {32.89999999, 0.596251619, 0.711201179},
                 {32.99999999, 0.596431863, 0.711270492},
                 {33.09999999, 0.596612108, 0.711338047},
                 {33.19999999, 0.596792352, 0.71140386},
                 {33.29999999, 0.596972596, 0.711467949},
                 {33.39999999, 0.59715284, 0.711530329},
                 {33.49999999, 0.597333084, 0.711591017},
                 {33.59999999, 0.597513328, 0.71165003},
                 {33.69999999, 0.597693572, 0.711707384},
                 {33.79999999, 0.597873817, 0.711763095},
                 {33.89999999, 0.598054061, 0.711817178},
                 {33.99999999, 0.598234305, 0.711869649},
                 {34.09999999, 0.598414549, 0.711920523},
                 {34.19999999, 0.598594793, 0.711969815},
                 {34.29999999, 0.598775037, 0.712017541},
                 {34.39999999, 0.598955282, 0.712063715},
                 {34.49999999, 0.599135526, 0.712108352},
                 {34.59999999, 0.59931577, 0.712151466},
                 {34.69999999, 0.599496014, 0.712193072},
                 {34.79999999, 0.599676258, 0.712233184},
                 {34.89999999, 0.599856502, 0.712271816},
                 {34.99999999, 0.600018182, 0.71233102},
                 {35.09999999, 0.600107364, 0.712474823},
                 {35.19999999, 0.600196546, 0.712617165},
                 {35.29999999, 0.600285729, 0.712758058},
                 {35.39999999, 0.600374911, 0.712897516},
                 {35.49999999, 0.600464093, 0.713035551},
                 {35.59999999, 0.600553276, 0.713172174},
                 {35.69999999, 0.600642458, 0.713307398},
                 {35.79999999, 0.60073164, 0.713441236},
                 {35.89999999, 0.600820823, 0.713573698},
                 {35.99999999, 0.600910005, 0.713704797},
                 {36.09999999, 0.600999187, 0.713834544},
                 {36.19999999, 0.60108837, 0.713962951},
                 {36.29999999, 0.601177552, 0.714090029},
                 {36.39999999, 0.601266734, 0.71421579},
                 {36.49999999, 0.601355916, 0.714340243},
                 {36.59999999, 0.601445099, 0.714463402},
                 {36.69999999, 0.601534281, 0.714585275},
                 {36.79999999, 0.601623463, 0.714705874},
                 {36.89999999, 0.601712646, 0.714825211},
                 {36.99999999, 0.601801828, 0.714943294},
                 {37.09999999, 0.60189101, 0.715060135},
                 {37.19999999, 0.601980193, 0.715175743},
                 {37.29999999, 0.602069375, 0.71529013},
                 {37.39999999, 0.602158557, 0.715403305},
                 {37.49999999, 0.60224774, 0.715515278},
                 {37.59999999, 0.602336922, 0.715626059},
                 {37.69999999, 0.602426104, 0.715735657},
                 {37.79999999, 0.602515287, 0.715844083},
                 {37.89999999, 0.602604469, 0.715951345},
                 {37.99999999, 0.602693651, 0.716057454},
                 {38.09999999, 0.602782834, 0.716162419},
                 {38.19999999, 0.602872016, 0.716266248},
                 {38.29999999, 0.602961198, 0.716368952},
                 {38.39999999, 0.603050381, 0.716470538},
                 {38.49999999, 0.603139563, 0.716571017},
                 {38.59999999, 0.603228745, 0.716670396},
                 {38.69999999, 0.603317928, 0.716768686},
                 {38.79999999, 0.60340711, 0.716865893},
                 {38.89999999, 0.603496292, 0.716962028},
                 {38.99999999, 0.603585475, 0.717057098},
                 {39.09999999, 0.603674657, 0.717151112},
                 {39.19999999, 0.603763839, 0.717244078},
                 {39.29999999, 0.603853022, 0.717336005},
                 {39.39999999, 0.603942204, 0.7174269},
                 {39.49999999, 0.604031386, 0.717516772},
                 {39.59999999, 0.604120569, 0.717700776},
                 {39.69999999, 0.604209751, 0.717913439},
                 {39.79999999, 0.604298933, 0.718124438},
                 {39.89999999, 0.604388116, 0.718333787},
                 {39.99999999, 0.604477298, 0.718541498}}};
    }


protected:
    virtual void SetUp()
    {
        auto pvSample = std::make_shared<SpectralAveraging::PhotovoltaicSampleData>(
          *loadSampleData_1(), eqeFront(), eqeBack());

        const auto aSolarRadiation = loadSolarRadiationFile();
        const auto wl = aSolarRadiation.getXArray();

        constexpr double thickness{3.048e-3};   // [m]
        const auto aMaterial_1 =
          Material::nBandPhotovoltaicMaterial(pvSample,
                                              thickness,
                                              FenestrationCommon::MaterialType::Monolithic);


        aMaterial_1->setBandWavelengths(wl);
        const auto layer1 =
          SingleLayerOptics::PhotovoltaicSpecularLayer::createLayer(aMaterial_1, table());

        m_Layer = CMultiPaneSpecular::create({layer1});

        const MultiLayerOptics::CalculationProperties input{loadSolarRadiationFile(),
                                                            loadSolarRadiationFile().getXArray()};
        m_Layer->setCalculationProperties(input);
    }

public:
    [[nodiscard]] CMultiPaneSpecular & getLayer() const
    {
        return *m_Layer;
    }
};

TEST_F(Photovoltaic_DoublePane_Example1, Test1)
{
    SCOPED_TRACE("Begin Test: Double pane photovoltaic - Example 1.");

    constexpr double angle{0.0};
    constexpr double minLambda{0.3};
    constexpr double maxLambda{2.5};

    auto aLayer = getLayer();

    const double T =
      aLayer.getPropertySimple(minLambda, maxLambda,PropertySimple::T, Side::Front, Scattering::DirectDirect, angle, 0);
    EXPECT_NEAR(0.2, T, 1e-6);

    const double absHeat = aLayer.AbsHeat(1, angle, minLambda, maxLambda, Side::Front);
    EXPECT_NEAR(0.670842, absHeat, 1e-6);

    const double absEl1 = aLayer.AbsElectricity(1, angle, minLambda, maxLambda, Side::Front);
    EXPECT_NEAR(0.106243, absEl1, 1e-6);
}